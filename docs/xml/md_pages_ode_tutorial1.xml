<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.20" xml:lang="en-US">
  <compounddef id="md_pages_ode_tutorial1" kind="page">
    <compoundname>md_pages_ode_tutorial1</compoundname>
    <title>Explicit Time Integration</title>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para> <mcss:class xmlns:mcss="http://mcss.mosra.cz/doxygen/" mcss:class="m-block m-info" /></para>
<para><simplesect kind="par"><title></title><para>This tutorial shows how to do explicit time integration in pressio.</para>
</simplesect>
<programlisting filename=".cpp"><codeline><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>main(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>argc,<sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*argv[])</highlight></codeline>
<codeline><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>std::cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Running<sp/>tutorial<sp/>2\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>We<sp/>illustrate<sp/>here<sp/>how<sp/>to<sp/>leverage<sp/>the<sp/>package<sp/>pressio/ode<sp/>to<sp/>do</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>explicit<sp/>time-integration<sp/>for<sp/>a<sp/>system<sp/>of<sp/>ODEs<sp/>with<sp/>Eigen<sp/>data<sp/>types,</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>which<sp/>is<sp/>supported<sp/>by<sp/>pressio.</highlight></codeline>
<codeline><highlight class="comment"></highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>Suppose<sp/>that<sp/>you<sp/>need<sp/>to<sp/>use<sp/>some<sp/>pressio/ode<sp/>package<sp/>for<sp/>doing<sp/>explicit<sp/>time</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>integration<sp/>of<sp/>a<sp/>system<sp/>of<sp/>ODEs<sp/>which<sp/>is<sp/>implemented<sp/>as<sp/>in<sp/>MyApp<sp/>above.</highlight></codeline>
<codeline><highlight class="comment"></highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>For<sp/>the<sp/>sake<sp/>of<sp/>explanation,<sp/>MyApp<sp/>at<sp/>the<sp/>top<sp/>of<sp/>this<sp/>page<sp/>is<sp/>a<sp/>class</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>that<sp/>defines<sp/>the<sp/>target<sp/>system<sp/>of<sp/>ODEs<sp/>and<sp/>meets</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>the<sp/>API<sp/>needed<sp/>by<sp/>pressio<sp/>to<sp/>run<sp/>explicit<sp/>time<sp/>integration,<sp/>i.e.:</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>(a)<sp/>it<sp/>has<sp/>typedefs<sp/>that<sp/>pressio<sp/>detects<sp/>for<sp/>scalar,<sp/>state<sp/>and<sp/>velicity</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>(b)<sp/>it<sp/>has<sp/>two<sp/>overleads<sp/>for<sp/>the<sp/>velocity()<sp/>method<sp/>(one<sp/>void<sp/>and<sp/>one<sp/>non-void)</highlight></codeline>
<codeline><highlight class="comment"></highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>As<sp/>long<sp/>as<sp/>the<sp/>user-defined<sp/>class/app<sp/>or<sp/>whatever<sp/>name<sp/>you<sp/>want<sp/>to<sp/>call<sp/>has<sp/>an</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>API<sp/>as<sp/>the<sp/>one<sp/>in<sp/>MyApp,<sp/>then<sp/>it<sp/>can<sp/>be<sp/>readily<sp/>used<sp/>with<sp/>pressio.</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>if<sp/>you<sp/>try<sp/>to<sp/>run<sp/>an<sp/>explicit<sp/>time<sp/>integration<sp/>with</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>a<sp/>user-defined<sp/>system<sp/>that<sp/>does<sp/>not<sp/>satisfy<sp/>the<sp/>target<sp/>API,</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>pressio<sp/>throws<sp/>a<sp/>compile-time<sp/>error.</highlight></codeline>
<codeline><highlight class="comment"></highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/><sp/><sp/>for<sp/>this<sp/>tutorial,<sp/>let<sp/>us<sp/>run<sp/>Forward<sp/>Euler<sp/>on<sp/>the<sp/>system<sp/>defined<sp/>by<sp/>MyApp.</highlight></codeline>
<codeline><highlight class="comment"><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>***<sp/>define<sp/>some<sp/>types<sp/>***</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>app_t<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>MyApp;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>scalar_t<sp/><sp/><sp/><sp/>=<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>app_t::scalar_type;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>native_state_t<sp/><sp/>=<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>app_t::state_type;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>native_veloc_t<sp/><sp/>=<sp/></highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>app_t::velocity_type;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>***<sp/>create<sp/>the<sp/>app<sp/>object<sp/>***</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>app_t<sp/>appObj;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>***<sp/>define<sp/>pressio<sp/>wrapper<sp/>types<sp/>for<sp/>the<sp/>state<sp/>***</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>in<sp/>this<sp/>case,<sp/>pressio<sp/>behind<sp/>the<sp/>scenes<sp/>detects<sp/>what<sp/>type<sp/>you</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>are<sp/>passing<sp/>as<sp/>template<sp/>argument<sp/>and<sp/>since<sp/>it<sp/>is<sp/>not<sp/>(for<sp/>now)<sp/>supported,</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>pressio<sp/>still<sp/>wraps<sp/>the<sp/>object<sp/>but<sp/>does<sp/>not<sp/>know<sp/>how<sp/>to<sp/>do<sp/>anythin<sp/>else.</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>state_t<sp/>=<sp/>::pressio::containers::Vector&lt;native_state_t&gt;;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>***<sp/>create<sp/>the<sp/>initial<sp/>state<sp/>object<sp/>***</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>state_t<sp/>y(3);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>***<sp/>fill<sp/>the<sp/>initial<sp/>state<sp/>vector<sp/>***</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>any<sp/>pressio<sp/>wrapper<sp/>provides<sp/>the<sp/>data()<sp/>method<sp/>to<sp/>get<sp/>a<sp/>pointer<sp/>to<sp/>the<sp/>wrapped<sp/>object</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>yptr<sp/>=<sp/>y.data();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>i<sp/>can<sp/>now<sp/>use<sp/>regular<sp/>std<sp/>vector<sp/>[]<sp/>operator<sp/>to<sp/>fill<sp/>in</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>(*yptr)[0]<sp/>=<sp/>1.;<sp/>(*yptr)[1]<sp/>=<sp/>2.;<sp/>(*yptr)[2]<sp/>=<sp/>3.;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>***<sp/>create<sp/>the<sp/>pressio<sp/>stepper<sp/>***</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>ode_tag<sp/>=<sp/>::pressio::ode::explicitmethods::Euler;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>stepper_t<sp/>=<sp/>::pressio::ode::ExplicitStepper&lt;ode_tag,<sp/>state_t,<sp/>app_t&gt;;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>stepper_t<sp/>stepperObj(y,<sp/>appObj);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>***<sp/>integrated<sp/>in<sp/>time<sp/>***</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>scalar_t<sp/>dt<sp/>=<sp/>0.1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>::pressio::ode::advanceNSteps(stepperObj,<sp/>y,<sp/>0.0,<sp/>dt,<sp/>1ul);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//<sp/>check<sp/>solution<sp/>against<sp/>expected</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>std::cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Computed<sp/>solution:<sp/>[&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;&lt;<sp/>(*yptr)[0]<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>(*yptr)[1]<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>(*yptr)[2]<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;]<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;Expected<sp/>solution:<sp/>[2,4,6]<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;&lt;<sp/>std::endl;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
<para>And the system class is: <programlisting filename=".cpp"><codeline><highlight class="keyword">struct<sp/></highlight><highlight class="normal">MyApp{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>scalar_type<sp/><sp/><sp/>=<sp/>double;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>state_type<sp/><sp/><sp/><sp/>=<sp/>Eigen::VectorXd;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">using</highlight><highlight class="normal"><sp/>velocity_type<sp/>=<sp/>state_type;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>velocity(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>state_type<sp/>&amp;<sp/>y,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scalar_type<sp/>t,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>velocity_type<sp/>&amp;<sp/>R)</highlight><highlight class="keyword"><sp/>const</highlight><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>R(0)<sp/>=<sp/>10.<sp/>*<sp/>y(0);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>R(1)<sp/>=<sp/>10.<sp/>*<sp/>y(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>R(2)<sp/>=<sp/>10.<sp/>*<sp/>y(2);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>velocity_type<sp/>createVelocity()</highlight><highlight class="keyword"><sp/>const</highlight><highlight class="normal">{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>velocity_type(3);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>};</highlight></codeline>
<codeline><highlight class="normal">};</highlight></codeline>
</programlisting> </para>
    </detaileddescription>
  </compounddef>
</doxygen>

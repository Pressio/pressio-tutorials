<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Hyperreduced LSPG ROM Driver | Pressio|C++ Tutorials</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">Pressio|C++ Tutorials</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-12 m-col-m-none">
            <li>
              <a>ODE</a>
              <ol>
                <li><a href="md_pages_ode_tutorial1.html">Explicit Time Integration (Known Types)</a></li>
                <li><a href="md_pages_ode_tutorial2.html">Explicit Time Integration (Arbitrary Types)</a></li>
              </ol>
            </li>
            <li>
              <a>ROM</a>
              <ol>
                <li><a href="md_pages_rom_tutorial_lindec.html">Linear Decoder (Known Types)</a></li>
                <li><a href="md_pages_rom_tutorial_lindec_at.html">Linear Decoder (Arbitrary Types)</a></li>
                <li><a href="md_pages_rom_tutorial2.html">Default Galerkin explicit</a></li>
              </ol>
            </li>
            <li>
              <a href="md_pages_swe_main.html">Shallow Water Eq.</a>
              <ol>
                <li><a href="md_pages_swe_fom.html">FOM Driver</a></li>
                <li><a href="md_pages_swe_lspg.html">LSPG Driver</a></li>
                <li><a href="md_pages_swe_hrlspg.html">Hyper-reduced LSPG Driver</a></li>
                <li><a href="md_pages_swe_endtoend.html">End-to-end Usecase</a></li>
              </ol>
            </li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="4">
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          Hyperreduced LSPG ROM Driver
        </h1>
<aside class="m-block m-info"><p>This page walks through an example code to construct and run LSPR ROM of the SWE with <em>collocation-based hyperreduction</em>. The full code is available <a href="https://github.com/Pressio/pressio-tutorials/blob/swe2d_tutorial/tutorials/swe2d/online_phase/lspg_hyperReducedRom/main.cc">here</a>.</p></aside><p>First, we include the relevant headers.</p><pre class="m-code"><span class="cp">#include</span> <span class="cpf">&quot;pressio_rom_lspg.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;pressio_apps.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;read_basis.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;rom_time_integration_observer.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;CLI11.hpp&quot;</span><span class="cp"></span></pre><p>The main function starts by processing the command line arguments and we initialize the pressio logger.</p><pre class="m-code"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="n">CLI</span><span class="o">::</span><span class="n">App</span> <span class="n">app</span><span class="p">{</span><span class="s">&quot;Hyper-reduced LSPG ROM of 2D Shallow Water Equations&quot;</span><span class="p">};</span>

  <span class="k">using</span> <span class="n">scalar_t</span> <span class="o">=</span> <span class="kt">double</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">64</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">romSizePerDof</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
  <span class="n">scalar_t</span> <span class="n">finalTime</span> <span class="o">=</span> <span class="mf">10.</span><span class="p">;</span>
  <span class="n">scalar_t</span> <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">;</span>
  <span class="n">scalar_t</span> <span class="n">gravity</span> <span class="o">=</span> <span class="mf">7.5</span><span class="p">;</span>
  <span class="n">scalar_t</span> <span class="n">pulse</span>   <span class="o">=</span> <span class="mf">0.125</span><span class="p">;</span>
  <span class="n">scalar_t</span> <span class="n">forcing</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>

  <span class="n">app</span><span class="p">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-k,--romSize&quot;</span><span class="p">,</span> <span class="n">romSizePerDof</span><span class="p">,</span>
         <span class="s">&quot;Number of modes for each dof to use: default = 10&quot;</span><span class="p">);</span>

  <span class="n">app</span><span class="p">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-N,--numCells&quot;</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span>
         <span class="s">&quot;Number of cells along each axis: default = 64&quot;</span><span class="p">);</span>

  <span class="n">app</span><span class="p">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-T,--finalTime&quot;</span><span class="p">,</span> <span class="n">finalTime</span><span class="p">,</span>
         <span class="s">&quot;Simulation time: default = 10.&quot;</span><span class="p">);</span>

  <span class="n">app</span><span class="p">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;--dt&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span>
         <span class="s">&quot;Time step size: default = 0.02&quot;</span><span class="p">);</span>

  <span class="n">app</span><span class="p">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-g,--gravity&quot;</span><span class="p">,</span> <span class="n">gravity</span><span class="p">,</span>
         <span class="s">&quot;Gravity value(s) to simulate: default = 7.5&quot;</span><span class="p">);</span>

  <span class="n">app</span><span class="p">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-p,--pulse&quot;</span><span class="p">,</span> <span class="n">pulse</span><span class="p">,</span>
         <span class="s">&quot;Pulse magnitude, default = 0.125&quot;</span><span class="p">);</span>

  <span class="n">app</span><span class="p">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f,--forcing&quot;</span><span class="p">,</span> <span class="n">forcing</span><span class="p">,</span>
         <span class="s">&quot;Forcing value(s) to simulate: default = 0.2&quot;</span><span class="p">);</span></pre><p>Next, we read information on the ROM and hyper-reduction, namely the global indices of the target sample mesh, stencil mesh, and relative sample mesh information.</p><pre class="m-code"><span class="c1">// Required for the app</span>
<span class="cm">/*</span>
<span class="cm">  read in the global indices (gids) of the sample mesh.</span>
<span class="cm">  Note that we could alternatively extract these</span>
<span class="cm">  from the information contained in sm_rel_lids and and smps_gids</span>
<span class="cm">*/</span>
<span class="k">auto</span> <span class="n">sampleMesh_gids</span> <span class="o">=</span> <span class="n">readSampleMeshGlobalIndices</span><span class="p">(</span><span class="s">&quot;sample_mesh_gids.txt&quot;</span><span class="p">);</span>
<span class="k">const</span> <span class="k">auto</span> <span class="n">sampleMeshSize</span> <span class="o">=</span> <span class="n">sampleMesh_gids</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="c1">// Required for the app</span>
<span class="cm">/*</span>
<span class="cm">  read in the global indices (gids) of the stencil mesh.</span>
<span class="cm">  The underlying app is a structured solver, and these indices</span>
<span class="cm">  allow us to find the correct location on a structured grid.</span>
<span class="cm">*/</span>
<span class="k">auto</span> <span class="n">sampleMeshPlusStencil_gids</span> <span class="o">=</span> <span class="n">readStencilMeshGlobalIndices</span><span class="p">(</span><span class="s">&quot;sample_mesh_plus_stencil_gids.txt&quot;</span><span class="p">);</span>
<span class="k">const</span> <span class="k">auto</span> <span class="n">sampleMeshPlusStencilSize</span> <span class="o">=</span> <span class="n">sampleMeshPlusStencil_gids</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>

<span class="c1">// Required for Pressio</span>
<span class="cm">/*</span>
<span class="cm">  read in the indices of the sample mesh relative to the stencil mesh,</span>
<span class="cm">  i.e., if the 4th element of the stencil mesh is the zeroth element</span>
<span class="cm">  of the sample mesh, then the zeroth entry would be sm_rel_lids(0) = 4;</span>
<span class="cm">*/</span>
<span class="k">auto</span> <span class="n">sampleMeshRelIds</span> <span class="o">=</span> <span class="n">readSampleMeshIndicesRelativeToStencil</span>
  <span class="p">(</span><span class="n">sampleMeshSize</span><span class="p">,</span> <span class="s">&quot;sample_mesh_relative_indices.txt&quot;</span><span class="p">);</span></pre><p>In the above, we have:</p><ol><li><code>sampleMesh_gids</code>: contains the global x,y indices of the sample mesh indices (this is required by the app). Note that this vector only contains information on the x,y cells used in the sample mesh, <strong>not</strong> the number of conserved variables.</li><li><code>sampleMeshPlusStencil_gids</code>: contains the global IDs of the stencil mesh (this is also required by the app). Note that this vector only contains information on the x,y cells used in the stencil mesh, but not the number of conserved variables.</li><li><p><code>sampleMeshRedIds</code>: contains the IDs of the sample mesh <em>relative</em> to the IDs of the stencil mesh. Note that this vector will contain information about not only the x,y cells, but also the conserved variables, and hence it has <em>3sampleMeshSize</em> entries. This data is required by Pressio, and is discussed more below. What do we mean by <em>information about the sample mesh indices, relative to the stencil mesh</em> For example, let&#x27;s say our FOM has the (zero-based) indices</p><div class="m-math"><svg style="width: 21.059em; height: 1.494em;" viewBox="93.188051 -14.396065 202.16687 14.346348">
<title>
\[ \mathcal{I}_{\text{FOM}} = \begin{Bmatrix} 0&amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 \end{Bmatrix}\]
</title>
<defs>
<path id='eq1-g1-8' d='M3.072478 4.770112C3.072478 5.606974 2.654047 6.06127 1.446575 6.539477C1.3868 6.563387 1.350934 6.611208 1.350934 6.682939C1.350934 6.77858 1.374844 6.814446 1.470486 6.850311C3.072478 7.47198 3.072478 8.117559 3.072478 8.787049V12.086675C3.084433 12.409465 3.263761 12.851806 3.789788 13.210461C4.375592 13.604981 5.34396 13.85604 5.451557 13.85604C5.571108 13.85604 5.606974 13.808219 5.606974 13.700623S5.583064 13.581071 5.403736 13.521295C5.057036 13.389788 4.124533 13.019178 3.93325 12.289913C3.897385 12.146451 3.897385 12.12254 3.897385 11.680199V8.751183C3.897385 8.129514 3.897385 7.256787 1.948692 6.694894C3.897385 6.097136 3.897385 5.284184 3.897385 4.614695V1.685679C3.897385 1.028144 3.897385 .406476 5.523288-.191283C5.606974-.215193 5.606974-.298879 5.606974-.32279C5.606974-.430386 5.571108-.478207 5.451557-.478207C5.36787-.478207 3.682192-.095641 3.263761 .6934C3.072478 1.052055 3.072478 1.159651 3.072478 1.673724V4.770112Z'/>
<path id='eq1-g1-9' d='M3.897385 8.607721C3.897385 8.2132 3.897385 7.47198 5.427646 6.862267C5.583064 6.802491 5.606974 6.802491 5.606974 6.682939C5.606974 6.659029 5.606974 6.575342 5.523288 6.551432C3.897385 5.917808 3.897385 5.272229 3.897385 4.590785V1.291158C3.873474 .645579 3.347447 .274969 3.156164 .143462C2.642092-.203238 1.637858-.478207 1.506351-.478207C1.3868-.478207 1.350934-.418431 1.350934-.32279C1.350934-.215193 1.41071-.191283 1.494396-.167372C3.072478 .430386 3.072478 1.028144 3.072478 1.697634V4.62665C3.072478 5.284184 3.072478 6.097136 5.009215 6.682939C3.072478 7.328518 3.072478 8.021918 3.072478 8.763138V11.692154C3.072478 12.313823 3.072478 12.947447 1.542217 13.521295C1.398755 13.581071 1.350934 13.593026 1.350934 13.700623C1.350934 13.796264 1.3868 13.85604 1.506351 13.85604C1.518306 13.85604 3.096389 13.557161 3.658281 12.76812C3.897385 12.42142 3.897385 12.158406 3.897385 11.70411V8.607721Z'/>
<path id='eq1-g3-48' d='M5.355915-3.825654C5.355915-4.817933 5.296139-5.786301 4.865753-6.694894C4.375592-7.687173 3.514819-7.950187 2.929016-7.950187C2.235616-7.950187 1.3868-7.603487 .944458-6.611208C.609714-5.858032 .490162-5.116812 .490162-3.825654C.490162-2.666002 .573848-1.793275 1.004234-.944458C1.470486-.035866 2.295392 .251059 2.917061 .251059C3.957161 .251059 4.554919-.37061 4.901619-1.06401C5.332005-1.960648 5.355915-3.132254 5.355915-3.825654ZM2.917061 .011955C2.534496 .011955 1.75741-.203238 1.530262-1.506351C1.398755-2.223661 1.398755-3.132254 1.398755-3.969116C1.398755-4.94944 1.398755-5.834122 1.590037-6.539477C1.793275-7.340473 2.402989-7.711083 2.917061-7.711083C3.371357-7.711083 4.064757-7.436115 4.291905-6.40797C4.447323-5.726526 4.447323-4.782067 4.447323-3.969116C4.447323-3.16812 4.447323-2.259527 4.315816-1.530262C4.088667-.215193 3.335492 .011955 2.917061 .011955Z'/>
<path id='eq1-g3-49' d='M3.443088-7.663263C3.443088-7.938232 3.443088-7.950187 3.203985-7.950187C2.917061-7.627397 2.319303-7.185056 1.08792-7.185056V-6.838356C1.362889-6.838356 1.960648-6.838356 2.618182-7.149191V-.920548C2.618182-.490162 2.582316-.3467 1.530262-.3467H1.159651V0C1.482441-.02391 2.642092-.02391 3.036613-.02391S4.578829-.02391 4.901619 0V-.3467H4.531009C3.478954-.3467 3.443088-.490162 3.443088-.920548V-7.663263Z'/>
<path id='eq1-g3-50' d='M5.260274-2.008468H4.99726C4.961395-1.80523 4.865753-1.147696 4.746202-.956413C4.662516-.848817 3.981071-.848817 3.622416-.848817H1.41071C1.733499-1.123786 2.462765-1.888917 2.773599-2.175841C4.590785-3.849564 5.260274-4.471233 5.260274-5.654795C5.260274-7.029639 4.172354-7.950187 2.785554-7.950187S.585803-6.766625 .585803-5.738481C.585803-5.128767 1.111831-5.128767 1.147696-5.128767C1.398755-5.128767 1.709589-5.308095 1.709589-5.69066C1.709589-6.025405 1.482441-6.252553 1.147696-6.252553C1.0401-6.252553 1.016189-6.252553 .980324-6.240598C1.207472-7.053549 1.853051-7.603487 2.630137-7.603487C3.646326-7.603487 4.267995-6.75467 4.267995-5.654795C4.267995-4.638605 3.682192-3.753923 3.000747-2.988792L.585803-.286924V0H4.94944L5.260274-2.008468Z'/>
<path id='eq1-g3-51' d='M2.199751-4.291905C1.996513-4.27995 1.948692-4.267995 1.948692-4.160399C1.948692-4.040847 2.008468-4.040847 2.223661-4.040847H2.773599C3.789788-4.040847 4.244085-3.203985 4.244085-2.056289C4.244085-.490162 3.431133-.071731 2.84533-.071731C2.271482-.071731 1.291158-.3467 .944458-1.135741C1.327024-1.075965 1.673724-1.291158 1.673724-1.721544C1.673724-2.068244 1.422665-2.307347 1.08792-2.307347C.800996-2.307347 .490162-2.139975 .490162-1.685679C.490162-.621669 1.554172 .251059 2.881196 .251059C4.303861 .251059 5.355915-.836862 5.355915-2.044334C5.355915-3.144209 4.471233-4.004981 3.323537-4.208219C4.363636-4.507098 5.033126-5.379826 5.033126-6.312329C5.033126-7.256787 4.052802-7.950187 2.893151-7.950187C1.697634-7.950187 .812951-7.220922 .812951-6.348194C.812951-5.869988 1.183562-5.774346 1.362889-5.774346C1.613948-5.774346 1.900872-5.953674 1.900872-6.312329C1.900872-6.694894 1.613948-6.862267 1.350934-6.862267C1.279203-6.862267 1.255293-6.862267 1.219427-6.850311C1.673724-7.663263 2.797509-7.663263 2.857285-7.663263C3.251806-7.663263 4.028892-7.483935 4.028892-6.312329C4.028892-6.085181 3.993026-5.415691 3.646326-4.901619C3.287671-4.375592 2.881196-4.339726 2.558406-4.327771L2.199751-4.291905Z'/>
<path id='eq1-g3-52' d='M4.315816-7.782814C4.315816-8.009963 4.315816-8.069738 4.148443-8.069738C4.052802-8.069738 4.016936-8.069738 3.921295-7.926276L.32279-2.343213V-1.996513H3.466999V-.908593C3.466999-.466252 3.443088-.3467 2.570361-.3467H2.331258V0C2.606227-.02391 3.550685-.02391 3.88543-.02391S5.176588-.02391 5.451557 0V-.3467H5.212453C4.351681-.3467 4.315816-.466252 4.315816-.908593V-1.996513H5.523288V-2.343213H4.315816V-7.782814ZM3.526775-6.850311V-2.343213H.621669L3.526775-6.850311Z'/>
<path id='eq1-g3-53' d='M1.530262-6.850311C2.044334-6.682939 2.462765-6.670984 2.594271-6.670984C3.945205-6.670984 4.805978-7.663263 4.805978-7.830635C4.805978-7.878456 4.782067-7.938232 4.710336-7.938232C4.686426-7.938232 4.662516-7.938232 4.554919-7.890411C3.88543-7.603487 3.311582-7.567621 3.000747-7.567621C2.211706-7.567621 1.649813-7.806725 1.422665-7.902366C1.338979-7.938232 1.315068-7.938232 1.303113-7.938232C1.207472-7.938232 1.207472-7.866501 1.207472-7.675218V-4.124533C1.207472-3.90934 1.207472-3.837609 1.350934-3.837609C1.41071-3.837609 1.422665-3.849564 1.542217-3.993026C1.876961-4.483188 2.438854-4.770112 3.036613-4.770112C3.670237-4.770112 3.981071-4.184309 4.076712-3.981071C4.27995-3.514819 4.291905-2.929016 4.291905-2.47472S4.291905-1.338979 3.957161-.800996C3.694147-.37061 3.227895-.071731 2.701868-.071731C1.912827-.071731 1.135741-.609714 .920548-1.482441C.980324-1.458531 1.052055-1.446575 1.111831-1.446575C1.315068-1.446575 1.637858-1.566127 1.637858-1.972603C1.637858-2.307347 1.41071-2.49863 1.111831-2.49863C.896638-2.49863 .585803-2.391034 .585803-1.924782C.585803-.908593 1.398755 .251059 2.725778 .251059C4.076712 .251059 5.260274-.884682 5.260274-2.402989C5.260274-3.825654 4.303861-5.009215 3.048568-5.009215C2.367123-5.009215 1.841096-4.710336 1.530262-4.375592V-6.850311Z'/>
<path id='eq1-g3-54' d='M1.470486-4.160399C1.470486-7.185056 2.940971-7.663263 3.58655-7.663263C4.016936-7.663263 4.447323-7.531756 4.674471-7.173101C4.531009-7.173101 4.076712-7.173101 4.076712-6.682939C4.076712-6.419925 4.25604-6.192777 4.566874-6.192777C4.865753-6.192777 5.068991-6.372105 5.068991-6.718804C5.068991-7.340473 4.614695-7.950187 3.574595-7.950187C2.068244-7.950187 .490162-6.40797 .490162-3.777833C.490162-.490162 1.924782 .251059 2.940971 .251059C4.244085 .251059 5.355915-.884682 5.355915-2.438854C5.355915-4.028892 4.244085-5.092902 3.048568-5.092902C1.984558-5.092902 1.590037-4.172354 1.470486-3.837609V-4.160399ZM2.940971-.071731C2.187796-.071731 1.829141-.74122 1.721544-.992279C1.613948-1.303113 1.494396-1.888917 1.494396-2.725778C1.494396-3.670237 1.924782-4.853798 3.000747-4.853798C3.658281-4.853798 4.004981-4.411457 4.184309-4.004981C4.375592-3.56264 4.375592-2.964882 4.375592-2.450809C4.375592-1.841096 4.375592-1.303113 4.148443-.848817C3.849564-.274969 3.419178-.071731 2.940971-.071731Z'/>
<path id='eq1-g3-55' d='M5.678705-7.424159V-7.699128H2.797509C1.350934-7.699128 1.327024-7.854545 1.279203-8.081694H1.016189L.645579-5.69066H.908593C.944458-5.905853 1.052055-6.647073 1.207472-6.77858C1.303113-6.850311 2.199751-6.850311 2.367123-6.850311H4.901619L3.634371-5.033126C3.311582-4.566874 2.10411-2.606227 2.10411-.358655C2.10411-.227148 2.10411 .251059 2.594271 .251059C3.096389 .251059 3.096389-.215193 3.096389-.37061V-.968369C3.096389-2.749689 3.383313-4.136488 3.945205-4.937484L5.678705-7.424159Z'/>
<path id='eq1-g3-56' d='M3.56264-4.315816C4.160399-4.638605 5.033126-5.188543 5.033126-6.192777C5.033126-7.232877 4.028892-7.950187 2.929016-7.950187C1.745455-7.950187 .812951-7.07746 .812951-5.989539C.812951-5.583064 .932503-5.176588 1.267248-4.770112C1.398755-4.614695 1.41071-4.60274 2.247572-4.016936C1.08792-3.478954 .490162-2.677958 .490162-1.80523C.490162-.537983 1.697634 .251059 2.917061 .251059C4.244085 .251059 5.355915-.729265 5.355915-1.984558C5.355915-3.203985 4.495143-3.741968 3.56264-4.315816ZM1.936737-5.391781C1.78132-5.499377 1.303113-5.810212 1.303113-6.396015C1.303113-7.173101 2.116065-7.663263 2.917061-7.663263C3.777833-7.663263 4.542964-7.041594 4.542964-6.180822C4.542964-5.451557 4.016936-4.865753 3.323537-4.483188L1.936737-5.391781ZM2.49863-3.849564L3.945205-2.905106C4.25604-2.701868 4.805978-2.331258 4.805978-1.601993C4.805978-.6934 3.88543-.071731 2.929016-.071731C1.912827-.071731 1.0401-.812951 1.0401-1.80523C1.0401-2.737733 1.721544-3.490909 2.49863-3.849564Z'/>
<path id='eq1-g3-57' d='M4.375592-3.478954C4.375592-.657534 3.120299-.071731 2.402989-.071731C2.116065-.071731 1.482441-.107597 1.183562-.526027H1.255293C1.338979-.502117 1.769365-.573848 1.769365-1.016189C1.769365-1.279203 1.590037-1.506351 1.279203-1.506351S.777086-1.303113 .777086-.992279C.777086-.251059 1.374844 .251059 2.414944 .251059C3.90934 .251059 5.355915-1.338979 5.355915-3.93325C5.355915-7.149191 4.016936-7.950187 2.964882-7.950187C1.649813-7.950187 .490162-6.850311 .490162-5.272229S1.601993-2.618182 2.797509-2.618182C3.682192-2.618182 4.136488-3.263761 4.375592-3.873474V-3.478954ZM2.84533-2.857285C2.092154-2.857285 1.769365-3.466999 1.661768-3.694147C1.470486-4.148443 1.470486-4.722291 1.470486-5.260274C1.470486-5.929763 1.470486-6.503611 1.78132-6.993773C1.996513-7.316563 2.319303-7.663263 2.964882-7.663263C3.646326-7.663263 3.993026-7.065504 4.112578-6.790535C4.351681-6.204732 4.351681-5.188543 4.351681-5.009215C4.351681-4.004981 3.897385-2.857285 2.84533-2.857285Z'/>
<path id='eq1-g3-61' d='M8.069738-3.873474C8.237111-3.873474 8.452304-3.873474 8.452304-4.088667C8.452304-4.315816 8.249066-4.315816 8.069738-4.315816H1.028144C.860772-4.315816 .645579-4.315816 .645579-4.100623C.645579-3.873474 .848817-3.873474 1.028144-3.873474H8.069738ZM8.069738-1.649813C8.237111-1.649813 8.452304-1.649813 8.452304-1.865006C8.452304-2.092154 8.249066-2.092154 8.069738-2.092154H1.028144C.860772-2.092154 .645579-2.092154 .645579-1.876961C.645579-1.649813 .848817-1.649813 1.028144-1.649813H8.069738Z'/>
<path id='eq1-g0-70' d='M4.351681-4.136488L4.327771-5.276214H.095641V-5.124782C.68543-5.076961 .789041-4.96538 .789041-4.407472V-.956413C.789041-.294894 .70137-.191283 .095641-.151432V0H2.327273V-.151432C1.713574-.183313 1.601993-.294894 1.601993-.868742V-2.606227H2.757659C3.403238-2.606227 3.53873-2.486675 3.634371-1.841096H3.817684V-3.690162H3.634371C3.53873-3.052553 3.395268-2.933001 2.757659-2.933001H1.601993V-4.702366C1.601993-4.925529 1.641843-4.97335 1.857036-4.97335H2.940971C3.841594-4.97335 4.016936-4.853798 4.152428-4.136488H4.351681Z'/>
<path id='eq1-g0-77' d='M6.878207 0V-.151432C6.296389-.191283 6.184807-.302864 6.184807-.868742V-4.407472C6.184807-4.97335 6.288418-5.076961 6.878207-5.124782V-5.276214H5.292154L3.53076-1.251308L1.689664-5.276214H.111582V-5.124782C.765131-5.084932 .868742-4.98929 .868742-4.407472V-1.171606C.868742-.350685 .757161-.199253 .095641-.151432V0H1.968618V-.151432C1.354919-.183313 1.219427-.366625 1.219427-1.171606V-4.383562L3.219925 0H3.331507L5.371856-4.566874V-.956413C5.371856-.294894 5.276214-.191283 4.646575-.151432V0H6.878207Z'/>
<path id='eq1-g0-79' d='M5.483437-2.606227C5.483437-3.395268 5.252304-4.072727 4.813948-4.550934C4.311831-5.100872 3.642341-5.387796 2.87721-5.387796C1.354919-5.387796 .270984-4.2401 .270984-2.638107C.270984-1.888917 .526027-1.163636 .956413-.70137C1.41868-.199253 2.12802 .111582 2.82939 .111582C4.399502 .111582 5.483437-1.004234 5.483437-2.606227ZM4.574844-2.614197C4.574844-2.14396 4.471233-1.594022 4.311831-1.179577C4.2401-.980324 4.104608-.781071 3.921295-.597758C3.642341-.318804 3.283686-.175342 2.86127-.175342C2.494645-.175342 2.13599-.318804 1.857036-.565878C1.44259-.932503 1.179577-1.737484 1.179577-2.622167C1.179577-3.435118 1.40274-4.208219 1.737484-4.582814C2.048319-4.925529 2.438854-5.100872 2.87721-5.100872C3.243836-5.100872 3.610461-4.95741 3.897385-4.702366C4.327771-4.311831 4.574844-3.56264 4.574844-2.614197Z'/>
<path id='eq1-g2-73' d='M4.244085-8.16538C2.761644-8.16538 2.116065-7.890411 1.829141-7.782814C.609714-7.268742 .334745-6.455791 .334745-6.300374C.334745-6.216687 .394521-6.204732 .466252-6.204732C.681445-6.204732 1.255293-6.503611 1.350934-6.766625C1.494396-7.220922 1.530262-7.328518 2.331258-7.436115C2.737733-7.483935 3.132254-7.507846 3.53873-7.507846H4.62665C3.873474-6.77858 3.526775-5.499377 3.096389-3.777833C2.749689-2.367123 2.47472-1.43462 1.984558-.800996C1.865006-.669489 1.853051-.657534 1.530262-.657534H.765131C.537983-.657534 .406476-.657534 .107597-.478207C-.02391-.406476-.286924-.203238-.286924-.083686C-.286924-.011955-.274969 0-.011955 0H4.076712C5.475467 0 6.515567-1.0401 6.515567-1.470486C6.515567-1.554172 6.419925-1.554172 6.38406-1.554172C6.180822-1.554172 5.618929-1.279203 5.499377-.980324C5.415691-.729265 5.379826-.657534 4.782067-.657534H2.49863C3.347447-1.3868 3.706102-2.570361 4.112578-4.196264C4.435367-5.499377 4.722291-6.659029 5.212453-7.388294C5.284184-7.49589 5.296139-7.507846 5.535243-7.507846H6.551432C6.790535-7.507846 6.898132-7.507846 7.208966-7.687173C7.316563-7.746949 7.591532-7.938232 7.591532-8.081694C7.591532-8.153425 7.579577-8.16538 7.316563-8.16538H4.244085Z'/>
</defs>
<g id='eq1-page1'>
<use x='93.188051' y='-4.234107' xlink:href='#eq1-g2-73'/>
<use x='99.697827' y='-2.440844' xlink:href='#eq1-g0-70'/>
<use x='104.129207' y='-2.440844' xlink:href='#eq1-g0-79'/>
<use x='109.883629' y='-2.440844' xlink:href='#eq1-g0-77'/>
<use x='120.788019' y='-4.234107' xlink:href='#eq1-g3-61'/>
<use x='133.2135' y='-13.91787' xlink:href='#eq1-g1-8'/>
<use x='140.187379' y='-4.333785' xlink:href='#eq1-g3-48'/>
<use x='156.003009' y='-4.333785' xlink:href='#eq1-g3-49'/>
<use x='171.818639' y='-4.333785' xlink:href='#eq1-g3-50'/>
<use x='187.63427' y='-4.333785' xlink:href='#eq1-g3-51'/>
<use x='203.4499' y='-4.333785' xlink:href='#eq1-g3-52'/>
<use x='219.26553' y='-4.333785' xlink:href='#eq1-g3-53'/>
<use x='235.081161' y='-4.333785' xlink:href='#eq1-g3-54'/>
<use x='250.896791' y='-4.333785' xlink:href='#eq1-g3-55'/>
<use x='266.712421' y='-4.333785' xlink:href='#eq1-g3-56'/>
<use x='282.528052' y='-4.333785' xlink:href='#eq1-g3-57'/>
<use x='288.381042' y='-13.91787' xlink:href='#eq1-g1-9'/>
</g>
</svg></div><p>Let&#x27;s say our sample mesh uses indices 3, 5, and 7,</p><div class="m-math"><svg style="width: 10.080em; height: 1.494em;" viewBox="145.888708 -14.396065 96.765555 14.346348">
<title>
\[ \mathcal{I}_{\text{sample}} = \begin{Bmatrix} 3 &amp; 5 &amp; 7 \end{Bmatrix}\]
</title>
<defs>
<path id='eq2-g1-8' d='M3.072478 4.770112C3.072478 5.606974 2.654047 6.06127 1.446575 6.539477C1.3868 6.563387 1.350934 6.611208 1.350934 6.682939C1.350934 6.77858 1.374844 6.814446 1.470486 6.850311C3.072478 7.47198 3.072478 8.117559 3.072478 8.787049V12.086675C3.084433 12.409465 3.263761 12.851806 3.789788 13.210461C4.375592 13.604981 5.34396 13.85604 5.451557 13.85604C5.571108 13.85604 5.606974 13.808219 5.606974 13.700623S5.583064 13.581071 5.403736 13.521295C5.057036 13.389788 4.124533 13.019178 3.93325 12.289913C3.897385 12.146451 3.897385 12.12254 3.897385 11.680199V8.751183C3.897385 8.129514 3.897385 7.256787 1.948692 6.694894C3.897385 6.097136 3.897385 5.284184 3.897385 4.614695V1.685679C3.897385 1.028144 3.897385 .406476 5.523288-.191283C5.606974-.215193 5.606974-.298879 5.606974-.32279C5.606974-.430386 5.571108-.478207 5.451557-.478207C5.36787-.478207 3.682192-.095641 3.263761 .6934C3.072478 1.052055 3.072478 1.159651 3.072478 1.673724V4.770112Z'/>
<path id='eq2-g1-9' d='M3.897385 8.607721C3.897385 8.2132 3.897385 7.47198 5.427646 6.862267C5.583064 6.802491 5.606974 6.802491 5.606974 6.682939C5.606974 6.659029 5.606974 6.575342 5.523288 6.551432C3.897385 5.917808 3.897385 5.272229 3.897385 4.590785V1.291158C3.873474 .645579 3.347447 .274969 3.156164 .143462C2.642092-.203238 1.637858-.478207 1.506351-.478207C1.3868-.478207 1.350934-.418431 1.350934-.32279C1.350934-.215193 1.41071-.191283 1.494396-.167372C3.072478 .430386 3.072478 1.028144 3.072478 1.697634V4.62665C3.072478 5.284184 3.072478 6.097136 5.009215 6.682939C3.072478 7.328518 3.072478 8.021918 3.072478 8.763138V11.692154C3.072478 12.313823 3.072478 12.947447 1.542217 13.521295C1.398755 13.581071 1.350934 13.593026 1.350934 13.700623C1.350934 13.796264 1.3868 13.85604 1.506351 13.85604C1.518306 13.85604 3.096389 13.557161 3.658281 12.76812C3.897385 12.42142 3.897385 12.158406 3.897385 11.70411V8.607721Z'/>
<path id='eq2-g3-51' d='M2.199751-4.291905C1.996513-4.27995 1.948692-4.267995 1.948692-4.160399C1.948692-4.040847 2.008468-4.040847 2.223661-4.040847H2.773599C3.789788-4.040847 4.244085-3.203985 4.244085-2.056289C4.244085-.490162 3.431133-.071731 2.84533-.071731C2.271482-.071731 1.291158-.3467 .944458-1.135741C1.327024-1.075965 1.673724-1.291158 1.673724-1.721544C1.673724-2.068244 1.422665-2.307347 1.08792-2.307347C.800996-2.307347 .490162-2.139975 .490162-1.685679C.490162-.621669 1.554172 .251059 2.881196 .251059C4.303861 .251059 5.355915-.836862 5.355915-2.044334C5.355915-3.144209 4.471233-4.004981 3.323537-4.208219C4.363636-4.507098 5.033126-5.379826 5.033126-6.312329C5.033126-7.256787 4.052802-7.950187 2.893151-7.950187C1.697634-7.950187 .812951-7.220922 .812951-6.348194C.812951-5.869988 1.183562-5.774346 1.362889-5.774346C1.613948-5.774346 1.900872-5.953674 1.900872-6.312329C1.900872-6.694894 1.613948-6.862267 1.350934-6.862267C1.279203-6.862267 1.255293-6.862267 1.219427-6.850311C1.673724-7.663263 2.797509-7.663263 2.857285-7.663263C3.251806-7.663263 4.028892-7.483935 4.028892-6.312329C4.028892-6.085181 3.993026-5.415691 3.646326-4.901619C3.287671-4.375592 2.881196-4.339726 2.558406-4.327771L2.199751-4.291905Z'/>
<path id='eq2-g3-53' d='M1.530262-6.850311C2.044334-6.682939 2.462765-6.670984 2.594271-6.670984C3.945205-6.670984 4.805978-7.663263 4.805978-7.830635C4.805978-7.878456 4.782067-7.938232 4.710336-7.938232C4.686426-7.938232 4.662516-7.938232 4.554919-7.890411C3.88543-7.603487 3.311582-7.567621 3.000747-7.567621C2.211706-7.567621 1.649813-7.806725 1.422665-7.902366C1.338979-7.938232 1.315068-7.938232 1.303113-7.938232C1.207472-7.938232 1.207472-7.866501 1.207472-7.675218V-4.124533C1.207472-3.90934 1.207472-3.837609 1.350934-3.837609C1.41071-3.837609 1.422665-3.849564 1.542217-3.993026C1.876961-4.483188 2.438854-4.770112 3.036613-4.770112C3.670237-4.770112 3.981071-4.184309 4.076712-3.981071C4.27995-3.514819 4.291905-2.929016 4.291905-2.47472S4.291905-1.338979 3.957161-.800996C3.694147-.37061 3.227895-.071731 2.701868-.071731C1.912827-.071731 1.135741-.609714 .920548-1.482441C.980324-1.458531 1.052055-1.446575 1.111831-1.446575C1.315068-1.446575 1.637858-1.566127 1.637858-1.972603C1.637858-2.307347 1.41071-2.49863 1.111831-2.49863C.896638-2.49863 .585803-2.391034 .585803-1.924782C.585803-.908593 1.398755 .251059 2.725778 .251059C4.076712 .251059 5.260274-.884682 5.260274-2.402989C5.260274-3.825654 4.303861-5.009215 3.048568-5.009215C2.367123-5.009215 1.841096-4.710336 1.530262-4.375592V-6.850311Z'/>
<path id='eq2-g3-55' d='M5.678705-7.424159V-7.699128H2.797509C1.350934-7.699128 1.327024-7.854545 1.279203-8.081694H1.016189L.645579-5.69066H.908593C.944458-5.905853 1.052055-6.647073 1.207472-6.77858C1.303113-6.850311 2.199751-6.850311 2.367123-6.850311H4.901619L3.634371-5.033126C3.311582-4.566874 2.10411-2.606227 2.10411-.358655C2.10411-.227148 2.10411 .251059 2.594271 .251059C3.096389 .251059 3.096389-.215193 3.096389-.37061V-.968369C3.096389-2.749689 3.383313-4.136488 3.945205-4.937484L5.678705-7.424159Z'/>
<path id='eq2-g3-61' d='M8.069738-3.873474C8.237111-3.873474 8.452304-3.873474 8.452304-4.088667C8.452304-4.315816 8.249066-4.315816 8.069738-4.315816H1.028144C.860772-4.315816 .645579-4.315816 .645579-4.100623C.645579-3.873474 .848817-3.873474 1.028144-3.873474H8.069738ZM8.069738-1.649813C8.237111-1.649813 8.452304-1.649813 8.452304-1.865006C8.452304-2.092154 8.249066-2.092154 8.069738-2.092154H1.028144C.860772-2.092154 .645579-2.092154 .645579-1.876961C.645579-1.649813 .848817-1.649813 1.028144-1.649813H8.069738Z'/>
<path id='eq2-g0-97' d='M3.52279-.318804V-.526027C3.387298-.414446 3.291656-.374595 3.172105-.374595C2.988792-.374595 2.933001-.486177 2.933001-.836862V-2.391034C2.933001-2.797509 2.893151-3.020672 2.781569-3.203985C2.614197-3.506849 2.271482-3.666252 1.785305-3.666252C1.378829-3.666252 .996264-3.55467 .773101-3.371357C.573848-3.203985 .446326-2.972852 .446326-2.773599C.446326-2.590286 .597758-2.430884 .789041-2.430884S1.147696-2.590286 1.147696-2.765629C1.147696-2.797509 1.139726-2.83736 1.131756-2.893151C1.115816-2.964882 1.107846-3.028643 1.107846-3.084433C1.107846-3.299626 1.362889-3.474969 1.681694-3.474969C2.072229-3.474969 2.287422-3.243836 2.287422-2.81345V-2.327273C1.060025-1.833126 .924533-1.769365 .581818-1.466501C.406476-1.307098 .294894-1.036115 .294894-.773101C.294894-.270984 .637609 .079701 1.131756 .079701C1.482441 .079701 1.809215-.087671 2.295392-.502117C2.335243-.079701 2.478705 .079701 2.805479 .079701C3.076463 .079701 3.243836-.01594 3.52279-.318804ZM2.287422-.980324C2.287422-.73325 2.247572-.661519 2.080199-.557908C1.888917-.446326 1.665753-.382565 1.498381-.382565C1.219427-.382565 .996264-.653549 .996264-.996264V-1.028144C.996264-1.498381 1.323039-1.785305 2.287422-2.13599V-.980324Z'/>
<path id='eq2-g0-101' d='M3.379328-1.251308L3.251806-1.307098C2.86924-.70137 2.526526-.470237 2.016438-.470237C1.578082-.470237 1.243337-.67746 1.012204-1.107846C.852802-1.41868 .789041-1.697634 .773101-2.207721H3.227895C3.164134-2.725778 3.084433-2.956912 2.885181-3.211955C2.646077-3.498879 2.279452-3.666252 1.865006-3.666252C.876712-3.666252 .199253-2.86924 .199253-1.705604C.199253-.605729 .773101 .079701 1.689664 .079701C2.454795 .079701 3.044583-.390535 3.379328-1.251308ZM2.414944-2.462765H.789041C.876712-3.092403 1.147696-3.379328 1.633873-3.379328S2.311333-3.156164 2.414944-2.462765Z'/>
<path id='eq2-g0-108' d='M2.048319 0V-.119552C1.538232-.151432 1.45056-.231133 1.45056-.669489V-5.427646L1.41868-5.443587C1.004234-5.308095 .70137-5.228394 .151432-5.092902V-4.96538H.199253C.286924-4.97335 .382565-4.98132 .446326-4.98132C.70137-4.98132 .781071-4.869738 .781071-4.495143V-.6934C.781071-.263014 .669489-.159402 .167372-.119552V0H2.048319Z'/>
<path id='eq2-g0-109' d='M6.176837 0V-.119552L5.969614-.135492C5.730511-.151432 5.626899-.294894 5.626899-.605729V-2.247572C5.626899-3.188045 5.316065-3.666252 4.702366-3.666252C4.2401-3.666252 3.833624-3.459029 3.403238-2.996762C3.259776-3.451059 2.988792-3.666252 2.558406-3.666252C2.207721-3.666252 1.984558-3.55467 1.323039-3.052553V-3.650311L1.267248-3.666252C.860772-3.514819 .589788-3.427148 .151432-3.307597V-3.172105C.255044-3.196015 .318804-3.203985 .406476-3.203985C.613699-3.203985 .68543-3.076463 .68543-2.693898V-.67746C.68543-.247073 .573848-.127522 .127522-.119552V0H1.896887V-.119552C1.474471-.135492 1.354919-.223163 1.354919-.533998V-2.781569C1.354919-2.781569 1.41868-2.87721 1.474471-2.933001C1.673724-3.116314 2.016438-3.251806 2.295392-3.251806C2.646077-3.251806 2.82142-2.972852 2.82142-2.414944V-.68543C2.82142-.239103 2.733748-.151432 2.279452-.119552V0H4.064757V-.119552C3.610461-.127522 3.490909-.263014 3.490909-.757161V-2.765629C3.730012-3.108344 3.993026-3.251806 4.359651-3.251806C4.813948-3.251806 4.95741-3.036613 4.95741-2.375093V-.6934C4.95741-.239103 4.893649-.175342 4.431382-.119552V0H6.176837Z'/>
<path id='eq2-g0-112' d='M3.745953-1.968618C3.745953-2.956912 3.188045-3.666252 2.414944-3.666252C1.968618-3.666252 1.617933-3.466999 1.267248-3.036613V-3.650311L1.219427-3.666252C.789041-3.498879 .510087-3.395268 .071731-3.259776V-3.132254C.143462-3.140224 .199253-3.140224 .270984-3.140224C.541968-3.140224 .597758-3.060523 .597758-2.685928V1.044085C.597758 1.458531 .510087 1.546202 .039851 1.594022V1.729514H1.968618V1.586052C1.370859 1.578082 1.267248 1.490411 1.267248 .988294V-.263014C1.546202 0 1.737484 .079701 2.072229 .079701C3.012702 .079701 3.745953-.812951 3.745953-1.968618ZM3.060523-1.657783C3.060523-.773101 2.669988-.175342 2.096139-.175342C1.721544-.175342 1.267248-.462267 1.267248-.70137V-2.662017C1.267248-2.901121 1.713574-3.188045 2.080199-3.188045C2.669988-3.188045 3.060523-2.582316 3.060523-1.657783Z'/>
<path id='eq2-g0-115' d='M2.773599-.940473C2.773599-1.338979 2.590286-1.601993 2.10411-1.888917L1.243337-2.399004C1.020174-2.526526 .900623-2.725778 .900623-2.940971C.900623-3.267746 1.147696-3.482939 1.514321-3.482939C1.968618-3.482939 2.207721-3.219925 2.391034-2.502615H2.510585L2.478705-3.58655H2.391034L2.375093-3.57061C2.303362-3.514819 2.295392-3.506849 2.263512-3.506849C2.215691-3.506849 2.13599-3.52279 2.048319-3.56264C1.880946-3.626401 1.697634-3.658281 1.506351-3.658281C.852802-3.658281 .406476-3.259776 .406476-2.677958C.406476-2.231631 .661519-1.920797 1.338979-1.530262L1.801245-1.267248C2.080199-1.107846 2.215691-.916563 2.215691-.669489C2.215691-.318804 1.960648-.095641 1.554172-.095641C1.004234-.095641 .72528-.398506 .541968-1.211457H.414446V.03188H.518057C.573848-.047821 .605729-.063761 .70137-.063761C.789041-.063761 .876712-.047821 1.067995 0C1.291158 .047821 1.490411 .079701 1.657783 .079701C2.263512 .079701 2.773599-.382565 2.773599-.940473Z'/>
<path id='eq2-g2-73' d='M4.244085-8.16538C2.761644-8.16538 2.116065-7.890411 1.829141-7.782814C.609714-7.268742 .334745-6.455791 .334745-6.300374C.334745-6.216687 .394521-6.204732 .466252-6.204732C.681445-6.204732 1.255293-6.503611 1.350934-6.766625C1.494396-7.220922 1.530262-7.328518 2.331258-7.436115C2.737733-7.483935 3.132254-7.507846 3.53873-7.507846H4.62665C3.873474-6.77858 3.526775-5.499377 3.096389-3.777833C2.749689-2.367123 2.47472-1.43462 1.984558-.800996C1.865006-.669489 1.853051-.657534 1.530262-.657534H.765131C.537983-.657534 .406476-.657534 .107597-.478207C-.02391-.406476-.286924-.203238-.286924-.083686C-.286924-.011955-.274969 0-.011955 0H4.076712C5.475467 0 6.515567-1.0401 6.515567-1.470486C6.515567-1.554172 6.419925-1.554172 6.38406-1.554172C6.180822-1.554172 5.618929-1.279203 5.499377-.980324C5.415691-.729265 5.379826-.657534 4.782067-.657534H2.49863C3.347447-1.3868 3.706102-2.570361 4.112578-4.196264C4.435367-5.499377 4.722291-6.659029 5.212453-7.388294C5.284184-7.49589 5.296139-7.507846 5.535243-7.507846H6.551432C6.790535-7.507846 6.898132-7.507846 7.208966-7.687173C7.316563-7.746949 7.591532-7.938232 7.591532-8.081694C7.591532-8.153425 7.579577-8.16538 7.316563-8.16538H4.244085Z'/>
</defs>
<g id='eq2-page1'>
<use x='145.888708' y='-4.234107' xlink:href='#eq2-g2-73'/>
<use x='152.398484' y='-2.440844' xlink:href='#eq2-g0-115'/>
<use x='155.498857' y='-2.440844' xlink:href='#eq2-g0-97'/>
<use x='159.037589' y='-2.440844' xlink:href='#eq2-g0-109'/>
<use x='165.238335' y='-2.440844' xlink:href='#eq2-g0-112'/>
<use x='169.223391' y='-2.440844' xlink:href='#eq2-g0-108'/>
<use x='171.439081' y='-2.440844' xlink:href='#eq2-g0-101'/>
<use x='178.796774' y='-4.234107' xlink:href='#eq2-g3-61'/>
<use x='191.222255' y='-13.91787' xlink:href='#eq2-g1-8'/>
<use x='198.196134' y='-4.333785' xlink:href='#eq2-g3-51'/>
<use x='214.011764' y='-4.333785' xlink:href='#eq2-g3-53'/>
<use x='229.827394' y='-4.333785' xlink:href='#eq2-g3-55'/>
<use x='235.680385' y='-13.91787' xlink:href='#eq2-g1-9'/>
</g>
</svg></div></li></ol><p>Let&#x27;s suppose we use a three-point stencil in our numerical method. In this case, the stencil mesh would be</p><div class="m-math"><svg style="width: 16.473em; height: 1.494em;" viewBox="115.201919 -14.396065 158.139148 14.346348">
<title>
\[ \mathcal{I}_{\text{stencil}} = \begin{Bmatrix} 2&amp; 3 &amp; 4&amp; 5 &amp;6 &amp; 7 &amp; 8\end{Bmatrix}\]
</title>
<defs>
<path id='eq3-g3-50' d='M5.260274-2.008468H4.99726C4.961395-1.80523 4.865753-1.147696 4.746202-.956413C4.662516-.848817 3.981071-.848817 3.622416-.848817H1.41071C1.733499-1.123786 2.462765-1.888917 2.773599-2.175841C4.590785-3.849564 5.260274-4.471233 5.260274-5.654795C5.260274-7.029639 4.172354-7.950187 2.785554-7.950187S.585803-6.766625 .585803-5.738481C.585803-5.128767 1.111831-5.128767 1.147696-5.128767C1.398755-5.128767 1.709589-5.308095 1.709589-5.69066C1.709589-6.025405 1.482441-6.252553 1.147696-6.252553C1.0401-6.252553 1.016189-6.252553 .980324-6.240598C1.207472-7.053549 1.853051-7.603487 2.630137-7.603487C3.646326-7.603487 4.267995-6.75467 4.267995-5.654795C4.267995-4.638605 3.682192-3.753923 3.000747-2.988792L.585803-.286924V0H4.94944L5.260274-2.008468Z'/>
<path id='eq3-g3-51' d='M2.199751-4.291905C1.996513-4.27995 1.948692-4.267995 1.948692-4.160399C1.948692-4.040847 2.008468-4.040847 2.223661-4.040847H2.773599C3.789788-4.040847 4.244085-3.203985 4.244085-2.056289C4.244085-.490162 3.431133-.071731 2.84533-.071731C2.271482-.071731 1.291158-.3467 .944458-1.135741C1.327024-1.075965 1.673724-1.291158 1.673724-1.721544C1.673724-2.068244 1.422665-2.307347 1.08792-2.307347C.800996-2.307347 .490162-2.139975 .490162-1.685679C.490162-.621669 1.554172 .251059 2.881196 .251059C4.303861 .251059 5.355915-.836862 5.355915-2.044334C5.355915-3.144209 4.471233-4.004981 3.323537-4.208219C4.363636-4.507098 5.033126-5.379826 5.033126-6.312329C5.033126-7.256787 4.052802-7.950187 2.893151-7.950187C1.697634-7.950187 .812951-7.220922 .812951-6.348194C.812951-5.869988 1.183562-5.774346 1.362889-5.774346C1.613948-5.774346 1.900872-5.953674 1.900872-6.312329C1.900872-6.694894 1.613948-6.862267 1.350934-6.862267C1.279203-6.862267 1.255293-6.862267 1.219427-6.850311C1.673724-7.663263 2.797509-7.663263 2.857285-7.663263C3.251806-7.663263 4.028892-7.483935 4.028892-6.312329C4.028892-6.085181 3.993026-5.415691 3.646326-4.901619C3.287671-4.375592 2.881196-4.339726 2.558406-4.327771L2.199751-4.291905Z'/>
<path id='eq3-g3-52' d='M4.315816-7.782814C4.315816-8.009963 4.315816-8.069738 4.148443-8.069738C4.052802-8.069738 4.016936-8.069738 3.921295-7.926276L.32279-2.343213V-1.996513H3.466999V-.908593C3.466999-.466252 3.443088-.3467 2.570361-.3467H2.331258V0C2.606227-.02391 3.550685-.02391 3.88543-.02391S5.176588-.02391 5.451557 0V-.3467H5.212453C4.351681-.3467 4.315816-.466252 4.315816-.908593V-1.996513H5.523288V-2.343213H4.315816V-7.782814ZM3.526775-6.850311V-2.343213H.621669L3.526775-6.850311Z'/>
<path id='eq3-g3-53' d='M1.530262-6.850311C2.044334-6.682939 2.462765-6.670984 2.594271-6.670984C3.945205-6.670984 4.805978-7.663263 4.805978-7.830635C4.805978-7.878456 4.782067-7.938232 4.710336-7.938232C4.686426-7.938232 4.662516-7.938232 4.554919-7.890411C3.88543-7.603487 3.311582-7.567621 3.000747-7.567621C2.211706-7.567621 1.649813-7.806725 1.422665-7.902366C1.338979-7.938232 1.315068-7.938232 1.303113-7.938232C1.207472-7.938232 1.207472-7.866501 1.207472-7.675218V-4.124533C1.207472-3.90934 1.207472-3.837609 1.350934-3.837609C1.41071-3.837609 1.422665-3.849564 1.542217-3.993026C1.876961-4.483188 2.438854-4.770112 3.036613-4.770112C3.670237-4.770112 3.981071-4.184309 4.076712-3.981071C4.27995-3.514819 4.291905-2.929016 4.291905-2.47472S4.291905-1.338979 3.957161-.800996C3.694147-.37061 3.227895-.071731 2.701868-.071731C1.912827-.071731 1.135741-.609714 .920548-1.482441C.980324-1.458531 1.052055-1.446575 1.111831-1.446575C1.315068-1.446575 1.637858-1.566127 1.637858-1.972603C1.637858-2.307347 1.41071-2.49863 1.111831-2.49863C.896638-2.49863 .585803-2.391034 .585803-1.924782C.585803-.908593 1.398755 .251059 2.725778 .251059C4.076712 .251059 5.260274-.884682 5.260274-2.402989C5.260274-3.825654 4.303861-5.009215 3.048568-5.009215C2.367123-5.009215 1.841096-4.710336 1.530262-4.375592V-6.850311Z'/>
<path id='eq3-g3-54' d='M1.470486-4.160399C1.470486-7.185056 2.940971-7.663263 3.58655-7.663263C4.016936-7.663263 4.447323-7.531756 4.674471-7.173101C4.531009-7.173101 4.076712-7.173101 4.076712-6.682939C4.076712-6.419925 4.25604-6.192777 4.566874-6.192777C4.865753-6.192777 5.068991-6.372105 5.068991-6.718804C5.068991-7.340473 4.614695-7.950187 3.574595-7.950187C2.068244-7.950187 .490162-6.40797 .490162-3.777833C.490162-.490162 1.924782 .251059 2.940971 .251059C4.244085 .251059 5.355915-.884682 5.355915-2.438854C5.355915-4.028892 4.244085-5.092902 3.048568-5.092902C1.984558-5.092902 1.590037-4.172354 1.470486-3.837609V-4.160399ZM2.940971-.071731C2.187796-.071731 1.829141-.74122 1.721544-.992279C1.613948-1.303113 1.494396-1.888917 1.494396-2.725778C1.494396-3.670237 1.924782-4.853798 3.000747-4.853798C3.658281-4.853798 4.004981-4.411457 4.184309-4.004981C4.375592-3.56264 4.375592-2.964882 4.375592-2.450809C4.375592-1.841096 4.375592-1.303113 4.148443-.848817C3.849564-.274969 3.419178-.071731 2.940971-.071731Z'/>
<path id='eq3-g3-55' d='M5.678705-7.424159V-7.699128H2.797509C1.350934-7.699128 1.327024-7.854545 1.279203-8.081694H1.016189L.645579-5.69066H.908593C.944458-5.905853 1.052055-6.647073 1.207472-6.77858C1.303113-6.850311 2.199751-6.850311 2.367123-6.850311H4.901619L3.634371-5.033126C3.311582-4.566874 2.10411-2.606227 2.10411-.358655C2.10411-.227148 2.10411 .251059 2.594271 .251059C3.096389 .251059 3.096389-.215193 3.096389-.37061V-.968369C3.096389-2.749689 3.383313-4.136488 3.945205-4.937484L5.678705-7.424159Z'/>
<path id='eq3-g3-56' d='M3.56264-4.315816C4.160399-4.638605 5.033126-5.188543 5.033126-6.192777C5.033126-7.232877 4.028892-7.950187 2.929016-7.950187C1.745455-7.950187 .812951-7.07746 .812951-5.989539C.812951-5.583064 .932503-5.176588 1.267248-4.770112C1.398755-4.614695 1.41071-4.60274 2.247572-4.016936C1.08792-3.478954 .490162-2.677958 .490162-1.80523C.490162-.537983 1.697634 .251059 2.917061 .251059C4.244085 .251059 5.355915-.729265 5.355915-1.984558C5.355915-3.203985 4.495143-3.741968 3.56264-4.315816ZM1.936737-5.391781C1.78132-5.499377 1.303113-5.810212 1.303113-6.396015C1.303113-7.173101 2.116065-7.663263 2.917061-7.663263C3.777833-7.663263 4.542964-7.041594 4.542964-6.180822C4.542964-5.451557 4.016936-4.865753 3.323537-4.483188L1.936737-5.391781ZM2.49863-3.849564L3.945205-2.905106C4.25604-2.701868 4.805978-2.331258 4.805978-1.601993C4.805978-.6934 3.88543-.071731 2.929016-.071731C1.912827-.071731 1.0401-.812951 1.0401-1.80523C1.0401-2.737733 1.721544-3.490909 2.49863-3.849564Z'/>
<path id='eq3-g3-61' d='M8.069738-3.873474C8.237111-3.873474 8.452304-3.873474 8.452304-4.088667C8.452304-4.315816 8.249066-4.315816 8.069738-4.315816H1.028144C.860772-4.315816 .645579-4.315816 .645579-4.100623C.645579-3.873474 .848817-3.873474 1.028144-3.873474H8.069738ZM8.069738-1.649813C8.237111-1.649813 8.452304-1.649813 8.452304-1.865006C8.452304-2.092154 8.249066-2.092154 8.069738-2.092154H1.028144C.860772-2.092154 .645579-2.092154 .645579-1.876961C.645579-1.649813 .848817-1.649813 1.028144-1.649813H8.069738Z'/>
<path id='eq3-g1-8' d='M3.072478 4.770112C3.072478 5.606974 2.654047 6.06127 1.446575 6.539477C1.3868 6.563387 1.350934 6.611208 1.350934 6.682939C1.350934 6.77858 1.374844 6.814446 1.470486 6.850311C3.072478 7.47198 3.072478 8.117559 3.072478 8.787049V12.086675C3.084433 12.409465 3.263761 12.851806 3.789788 13.210461C4.375592 13.604981 5.34396 13.85604 5.451557 13.85604C5.571108 13.85604 5.606974 13.808219 5.606974 13.700623S5.583064 13.581071 5.403736 13.521295C5.057036 13.389788 4.124533 13.019178 3.93325 12.289913C3.897385 12.146451 3.897385 12.12254 3.897385 11.680199V8.751183C3.897385 8.129514 3.897385 7.256787 1.948692 6.694894C3.897385 6.097136 3.897385 5.284184 3.897385 4.614695V1.685679C3.897385 1.028144 3.897385 .406476 5.523288-.191283C5.606974-.215193 5.606974-.298879 5.606974-.32279C5.606974-.430386 5.571108-.478207 5.451557-.478207C5.36787-.478207 3.682192-.095641 3.263761 .6934C3.072478 1.052055 3.072478 1.159651 3.072478 1.673724V4.770112Z'/>
<path id='eq3-g1-9' d='M3.897385 8.607721C3.897385 8.2132 3.897385 7.47198 5.427646 6.862267C5.583064 6.802491 5.606974 6.802491 5.606974 6.682939C5.606974 6.659029 5.606974 6.575342 5.523288 6.551432C3.897385 5.917808 3.897385 5.272229 3.897385 4.590785V1.291158C3.873474 .645579 3.347447 .274969 3.156164 .143462C2.642092-.203238 1.637858-.478207 1.506351-.478207C1.3868-.478207 1.350934-.418431 1.350934-.32279C1.350934-.215193 1.41071-.191283 1.494396-.167372C3.072478 .430386 3.072478 1.028144 3.072478 1.697634V4.62665C3.072478 5.284184 3.072478 6.097136 5.009215 6.682939C3.072478 7.328518 3.072478 8.021918 3.072478 8.763138V11.692154C3.072478 12.313823 3.072478 12.947447 1.542217 13.521295C1.398755 13.581071 1.350934 13.593026 1.350934 13.700623C1.350934 13.796264 1.3868 13.85604 1.506351 13.85604C1.518306 13.85604 3.096389 13.557161 3.658281 12.76812C3.897385 12.42142 3.897385 12.158406 3.897385 11.70411V8.607721Z'/>
<path id='eq3-g0-99' d='M3.283686-1.171606L3.172105-1.243337C2.789539-.68543 2.502615-.494147 2.048319-.494147C1.315068-.494147 .812951-1.131756 .812951-2.048319C.812951-2.87721 1.251308-3.435118 1.896887-3.435118C2.183811-3.435118 2.287422-3.347447 2.367123-3.052553L2.414944-2.87721C2.478705-2.646077 2.622167-2.510585 2.797509-2.510585C3.004732-2.510585 3.172105-2.662017 3.172105-2.84533C3.172105-3.291656 2.614197-3.666252 1.944707-3.666252C1.570112-3.666252 1.187547-3.52279 .868742-3.259776C.438356-2.901121 .199253-2.351183 .199253-1.689664C.199253-.661519 .828892 .079701 1.713574 .079701C2.056289 .079701 2.359153-.03188 2.630137-.255044C2.86924-.446326 3.028643-.67746 3.283686-1.171606Z'/>
<path id='eq3-g0-101' d='M3.379328-1.251308L3.251806-1.307098C2.86924-.70137 2.526526-.470237 2.016438-.470237C1.578082-.470237 1.243337-.67746 1.012204-1.107846C.852802-1.41868 .789041-1.697634 .773101-2.207721H3.227895C3.164134-2.725778 3.084433-2.956912 2.885181-3.211955C2.646077-3.498879 2.279452-3.666252 1.865006-3.666252C.876712-3.666252 .199253-2.86924 .199253-1.705604C.199253-.605729 .773101 .079701 1.689664 .079701C2.454795 .079701 3.044583-.390535 3.379328-1.251308ZM2.414944-2.462765H.789041C.876712-3.092403 1.147696-3.379328 1.633873-3.379328S2.311333-3.156164 2.414944-2.462765Z'/>
<path id='eq3-g0-105' d='M2.016438 0V-.119552C1.490411-.159402 1.42665-.239103 1.42665-.812951V-3.642341L1.39477-3.666252L.159402-3.227895V-3.108344L.223163-3.116314C.318804-3.132254 .422416-3.140224 .494147-3.140224C.68543-3.140224 .757161-3.012702 .757161-2.662017V-.812951C.757161-.239103 .67746-.151432 .127522-.119552V0H2.016438ZM1.498381-5.037111C1.498381-5.260274 1.323039-5.443587 1.091905-5.443587C.868742-5.443587 .68543-5.260274 .68543-5.037111C.68543-4.805978 .868742-4.630635 1.091905-4.630635C1.323039-4.630635 1.498381-4.805978 1.498381-5.037111Z'/>
<path id='eq3-g0-108' d='M2.048319 0V-.119552C1.538232-.151432 1.45056-.231133 1.45056-.669489V-5.427646L1.41868-5.443587C1.004234-5.308095 .70137-5.228394 .151432-5.092902V-4.96538H.199253C.286924-4.97335 .382565-4.98132 .446326-4.98132C.70137-4.98132 .781071-4.869738 .781071-4.495143V-.6934C.781071-.263014 .669489-.159402 .167372-.119552V0H2.048319Z'/>
<path id='eq3-g0-110' d='M3.865504 0V-.119552C3.474969-.159402 3.379328-.255044 3.379328-.645579V-2.470735C3.379328-3.219925 3.028643-3.666252 2.438854-3.666252C2.072229-3.666252 1.825156-3.53076 1.283188-3.020672V-3.650311L1.227397-3.666252C.836862-3.52279 .565878-3.435118 .127522-3.307597V-3.172105C.175342-3.196015 .255044-3.203985 .342715-3.203985C.565878-3.203985 .637609-3.084433 .637609-2.693898V-.71731C.637609-.263014 .549938-.151432 .143462-.119552V0H1.833126V-.119552C1.42665-.151432 1.307098-.247073 1.307098-.533998V-2.773599C1.689664-3.132254 1.865006-3.227895 2.12802-3.227895C2.518555-3.227895 2.709838-2.980822 2.709838-2.454795V-.789041C2.709838-.286924 2.606227-.151432 2.207721-.119552V0H3.865504Z'/>
<path id='eq3-g0-115' d='M2.773599-.940473C2.773599-1.338979 2.590286-1.601993 2.10411-1.888917L1.243337-2.399004C1.020174-2.526526 .900623-2.725778 .900623-2.940971C.900623-3.267746 1.147696-3.482939 1.514321-3.482939C1.968618-3.482939 2.207721-3.219925 2.391034-2.502615H2.510585L2.478705-3.58655H2.391034L2.375093-3.57061C2.303362-3.514819 2.295392-3.506849 2.263512-3.506849C2.215691-3.506849 2.13599-3.52279 2.048319-3.56264C1.880946-3.626401 1.697634-3.658281 1.506351-3.658281C.852802-3.658281 .406476-3.259776 .406476-2.677958C.406476-2.231631 .661519-1.920797 1.338979-1.530262L1.801245-1.267248C2.080199-1.107846 2.215691-.916563 2.215691-.669489C2.215691-.318804 1.960648-.095641 1.554172-.095641C1.004234-.095641 .72528-.398506 .541968-1.211457H.414446V.03188H.518057C.573848-.047821 .605729-.063761 .70137-.063761C.789041-.063761 .876712-.047821 1.067995 0C1.291158 .047821 1.490411 .079701 1.657783 .079701C2.263512 .079701 2.773599-.382565 2.773599-.940473Z'/>
<path id='eq3-g0-116' d='M2.223661-.526027L2.12005-.613699C1.944707-.406476 1.817186-.334745 1.641843-.334745C1.346949-.334745 1.227397-.541968 1.227397-1.052055V-3.331507H2.032379V-3.58655H1.227397V-4.511083C1.227397-4.590785 1.211457-4.614695 1.171606-4.614695C1.123786-4.534994 1.067995-4.463263 1.012204-4.391532C.71731-3.953176 .446326-3.658281 .239103-3.53873C.151432-3.482939 .103611-3.435118 .103611-3.387298C.103611-3.363387 .111582-3.347447 .135492-3.331507H.557908V-.932503C.557908-.263014 .797011 .079701 1.259278 .079701C1.657783 .079701 1.960648-.111582 2.223661-.526027Z'/>
<path id='eq3-g2-73' d='M4.244085-8.16538C2.761644-8.16538 2.116065-7.890411 1.829141-7.782814C.609714-7.268742 .334745-6.455791 .334745-6.300374C.334745-6.216687 .394521-6.204732 .466252-6.204732C.681445-6.204732 1.255293-6.503611 1.350934-6.766625C1.494396-7.220922 1.530262-7.328518 2.331258-7.436115C2.737733-7.483935 3.132254-7.507846 3.53873-7.507846H4.62665C3.873474-6.77858 3.526775-5.499377 3.096389-3.777833C2.749689-2.367123 2.47472-1.43462 1.984558-.800996C1.865006-.669489 1.853051-.657534 1.530262-.657534H.765131C.537983-.657534 .406476-.657534 .107597-.478207C-.02391-.406476-.286924-.203238-.286924-.083686C-.286924-.011955-.274969 0-.011955 0H4.076712C5.475467 0 6.515567-1.0401 6.515567-1.470486C6.515567-1.554172 6.419925-1.554172 6.38406-1.554172C6.180822-1.554172 5.618929-1.279203 5.499377-.980324C5.415691-.729265 5.379826-.657534 4.782067-.657534H2.49863C3.347447-1.3868 3.706102-2.570361 4.112578-4.196264C4.435367-5.499377 4.722291-6.659029 5.212453-7.388294C5.284184-7.49589 5.296139-7.507846 5.535243-7.507846H6.551432C6.790535-7.507846 6.898132-7.507846 7.208966-7.687173C7.316563-7.746949 7.591532-7.938232 7.591532-8.081694C7.591532-8.153425 7.579577-8.16538 7.316563-8.16538H4.244085Z'/>
</defs>
<g id='eq3-page1'>
<use x='115.201919' y='-4.234107' xlink:href='#eq3-g2-73'/>
<use x='121.711695' y='-2.440844' xlink:href='#eq3-g0-115'/>
<use x='124.692506' y='-2.440844' xlink:href='#eq3-g0-116'/>
<use x='126.908196' y='-2.440844' xlink:href='#eq3-g0-101'/>
<use x='130.446928' y='-2.440844' xlink:href='#eq3-g0-110'/>
<use x='134.431984' y='-2.440844' xlink:href='#eq3-g0-99'/>
<use x='137.970716' y='-2.440844' xlink:href='#eq3-g0-105'/>
<use x='140.186406' y='-2.440844' xlink:href='#eq3-g0-108'/>
<use x='146.221057' y='-4.234107' xlink:href='#eq3-g3-61'/>
<use x='158.646538' y='-13.91787' xlink:href='#eq3-g1-8'/>
<use x='165.620417' y='-4.333785' xlink:href='#eq3-g3-50'/>
<use x='181.436047' y='-4.333785' xlink:href='#eq3-g3-51'/>
<use x='197.251677' y='-4.333785' xlink:href='#eq3-g3-52'/>
<use x='213.067308' y='-4.333785' xlink:href='#eq3-g3-53'/>
<use x='228.882938' y='-4.333785' xlink:href='#eq3-g3-54'/>
<use x='244.698568' y='-4.333785' xlink:href='#eq3-g3-55'/>
<use x='260.514199' y='-4.333785' xlink:href='#eq3-g3-56'/>
<use x='266.367189' y='-13.91787' xlink:href='#eq3-g1-9'/>
</g>
</svg></div><p>The indices of the <em>sample mesh</em> relative to the indices of the <em>stencil mesh</em> are thus</p><div class="m-math"><svg style="width: 8.604em; height: 1.494em;" viewBox="152.974138 -14.396065 82.594696 14.346348">
<title>
\[ \mathcal{I}_{\text{rel}} =\begin{Bmatrix} 1 &amp; 3 &amp; 5 \end{Bmatrix}\]
</title>
<defs>
<path id='eq4-g1-8' d='M3.072478 4.770112C3.072478 5.606974 2.654047 6.06127 1.446575 6.539477C1.3868 6.563387 1.350934 6.611208 1.350934 6.682939C1.350934 6.77858 1.374844 6.814446 1.470486 6.850311C3.072478 7.47198 3.072478 8.117559 3.072478 8.787049V12.086675C3.084433 12.409465 3.263761 12.851806 3.789788 13.210461C4.375592 13.604981 5.34396 13.85604 5.451557 13.85604C5.571108 13.85604 5.606974 13.808219 5.606974 13.700623S5.583064 13.581071 5.403736 13.521295C5.057036 13.389788 4.124533 13.019178 3.93325 12.289913C3.897385 12.146451 3.897385 12.12254 3.897385 11.680199V8.751183C3.897385 8.129514 3.897385 7.256787 1.948692 6.694894C3.897385 6.097136 3.897385 5.284184 3.897385 4.614695V1.685679C3.897385 1.028144 3.897385 .406476 5.523288-.191283C5.606974-.215193 5.606974-.298879 5.606974-.32279C5.606974-.430386 5.571108-.478207 5.451557-.478207C5.36787-.478207 3.682192-.095641 3.263761 .6934C3.072478 1.052055 3.072478 1.159651 3.072478 1.673724V4.770112Z'/>
<path id='eq4-g1-9' d='M3.897385 8.607721C3.897385 8.2132 3.897385 7.47198 5.427646 6.862267C5.583064 6.802491 5.606974 6.802491 5.606974 6.682939C5.606974 6.659029 5.606974 6.575342 5.523288 6.551432C3.897385 5.917808 3.897385 5.272229 3.897385 4.590785V1.291158C3.873474 .645579 3.347447 .274969 3.156164 .143462C2.642092-.203238 1.637858-.478207 1.506351-.478207C1.3868-.478207 1.350934-.418431 1.350934-.32279C1.350934-.215193 1.41071-.191283 1.494396-.167372C3.072478 .430386 3.072478 1.028144 3.072478 1.697634V4.62665C3.072478 5.284184 3.072478 6.097136 5.009215 6.682939C3.072478 7.328518 3.072478 8.021918 3.072478 8.763138V11.692154C3.072478 12.313823 3.072478 12.947447 1.542217 13.521295C1.398755 13.581071 1.350934 13.593026 1.350934 13.700623C1.350934 13.796264 1.3868 13.85604 1.506351 13.85604C1.518306 13.85604 3.096389 13.557161 3.658281 12.76812C3.897385 12.42142 3.897385 12.158406 3.897385 11.70411V8.607721Z'/>
<path id='eq4-g3-49' d='M3.443088-7.663263C3.443088-7.938232 3.443088-7.950187 3.203985-7.950187C2.917061-7.627397 2.319303-7.185056 1.08792-7.185056V-6.838356C1.362889-6.838356 1.960648-6.838356 2.618182-7.149191V-.920548C2.618182-.490162 2.582316-.3467 1.530262-.3467H1.159651V0C1.482441-.02391 2.642092-.02391 3.036613-.02391S4.578829-.02391 4.901619 0V-.3467H4.531009C3.478954-.3467 3.443088-.490162 3.443088-.920548V-7.663263Z'/>
<path id='eq4-g3-51' d='M2.199751-4.291905C1.996513-4.27995 1.948692-4.267995 1.948692-4.160399C1.948692-4.040847 2.008468-4.040847 2.223661-4.040847H2.773599C3.789788-4.040847 4.244085-3.203985 4.244085-2.056289C4.244085-.490162 3.431133-.071731 2.84533-.071731C2.271482-.071731 1.291158-.3467 .944458-1.135741C1.327024-1.075965 1.673724-1.291158 1.673724-1.721544C1.673724-2.068244 1.422665-2.307347 1.08792-2.307347C.800996-2.307347 .490162-2.139975 .490162-1.685679C.490162-.621669 1.554172 .251059 2.881196 .251059C4.303861 .251059 5.355915-.836862 5.355915-2.044334C5.355915-3.144209 4.471233-4.004981 3.323537-4.208219C4.363636-4.507098 5.033126-5.379826 5.033126-6.312329C5.033126-7.256787 4.052802-7.950187 2.893151-7.950187C1.697634-7.950187 .812951-7.220922 .812951-6.348194C.812951-5.869988 1.183562-5.774346 1.362889-5.774346C1.613948-5.774346 1.900872-5.953674 1.900872-6.312329C1.900872-6.694894 1.613948-6.862267 1.350934-6.862267C1.279203-6.862267 1.255293-6.862267 1.219427-6.850311C1.673724-7.663263 2.797509-7.663263 2.857285-7.663263C3.251806-7.663263 4.028892-7.483935 4.028892-6.312329C4.028892-6.085181 3.993026-5.415691 3.646326-4.901619C3.287671-4.375592 2.881196-4.339726 2.558406-4.327771L2.199751-4.291905Z'/>
<path id='eq4-g3-53' d='M1.530262-6.850311C2.044334-6.682939 2.462765-6.670984 2.594271-6.670984C3.945205-6.670984 4.805978-7.663263 4.805978-7.830635C4.805978-7.878456 4.782067-7.938232 4.710336-7.938232C4.686426-7.938232 4.662516-7.938232 4.554919-7.890411C3.88543-7.603487 3.311582-7.567621 3.000747-7.567621C2.211706-7.567621 1.649813-7.806725 1.422665-7.902366C1.338979-7.938232 1.315068-7.938232 1.303113-7.938232C1.207472-7.938232 1.207472-7.866501 1.207472-7.675218V-4.124533C1.207472-3.90934 1.207472-3.837609 1.350934-3.837609C1.41071-3.837609 1.422665-3.849564 1.542217-3.993026C1.876961-4.483188 2.438854-4.770112 3.036613-4.770112C3.670237-4.770112 3.981071-4.184309 4.076712-3.981071C4.27995-3.514819 4.291905-2.929016 4.291905-2.47472S4.291905-1.338979 3.957161-.800996C3.694147-.37061 3.227895-.071731 2.701868-.071731C1.912827-.071731 1.135741-.609714 .920548-1.482441C.980324-1.458531 1.052055-1.446575 1.111831-1.446575C1.315068-1.446575 1.637858-1.566127 1.637858-1.972603C1.637858-2.307347 1.41071-2.49863 1.111831-2.49863C.896638-2.49863 .585803-2.391034 .585803-1.924782C.585803-.908593 1.398755 .251059 2.725778 .251059C4.076712 .251059 5.260274-.884682 5.260274-2.402989C5.260274-3.825654 4.303861-5.009215 3.048568-5.009215C2.367123-5.009215 1.841096-4.710336 1.530262-4.375592V-6.850311Z'/>
<path id='eq4-g3-61' d='M8.069738-3.873474C8.237111-3.873474 8.452304-3.873474 8.452304-4.088667C8.452304-4.315816 8.249066-4.315816 8.069738-4.315816H1.028144C.860772-4.315816 .645579-4.315816 .645579-4.100623C.645579-3.873474 .848817-3.873474 1.028144-3.873474H8.069738ZM8.069738-1.649813C8.237111-1.649813 8.452304-1.649813 8.452304-1.865006C8.452304-2.092154 8.249066-2.092154 8.069738-2.092154H1.028144C.860772-2.092154 .645579-2.092154 .645579-1.876961C.645579-1.649813 .848817-1.649813 1.028144-1.649813H8.069738Z'/>
<path id='eq4-g0-101' d='M3.379328-1.251308L3.251806-1.307098C2.86924-.70137 2.526526-.470237 2.016438-.470237C1.578082-.470237 1.243337-.67746 1.012204-1.107846C.852802-1.41868 .789041-1.697634 .773101-2.207721H3.227895C3.164134-2.725778 3.084433-2.956912 2.885181-3.211955C2.646077-3.498879 2.279452-3.666252 1.865006-3.666252C.876712-3.666252 .199253-2.86924 .199253-1.705604C.199253-.605729 .773101 .079701 1.689664 .079701C2.454795 .079701 3.044583-.390535 3.379328-1.251308ZM2.414944-2.462765H.789041C.876712-3.092403 1.147696-3.379328 1.633873-3.379328S2.311333-3.156164 2.414944-2.462765Z'/>
<path id='eq4-g0-108' d='M2.048319 0V-.119552C1.538232-.151432 1.45056-.231133 1.45056-.669489V-5.427646L1.41868-5.443587C1.004234-5.308095 .70137-5.228394 .151432-5.092902V-4.96538H.199253C.286924-4.97335 .382565-4.98132 .446326-4.98132C.70137-4.98132 .781071-4.869738 .781071-4.495143V-.6934C.781071-.263014 .669489-.159402 .167372-.119552V0H2.048319Z'/>
<path id='eq4-g0-114' d='M2.669988-3.243836C2.669988-3.506849 2.502615-3.666252 2.231631-3.666252C1.896887-3.666252 1.665753-3.482939 1.275218-2.917061V-3.650311L1.235367-3.666252C.812951-3.490909 .526027-3.387298 .055791-3.235866V-3.108344C.167372-3.132254 .239103-3.140224 .334745-3.140224C.533998-3.140224 .605729-3.012702 .605729-2.662017V-.669489C.605729-.270984 .549938-.215193 .039851-.119552V0H1.952677V-.119552C1.41071-.143462 1.275218-.263014 1.275218-.71731V-2.510585C1.275218-2.765629 1.617933-3.164134 1.833126-3.164134C1.880946-3.164134 1.952677-3.124284 2.040349-3.044583C2.16787-2.933001 2.255542-2.885181 2.359153-2.885181C2.550436-2.885181 2.669988-3.020672 2.669988-3.243836Z'/>
<path id='eq4-g2-73' d='M4.244085-8.16538C2.761644-8.16538 2.116065-7.890411 1.829141-7.782814C.609714-7.268742 .334745-6.455791 .334745-6.300374C.334745-6.216687 .394521-6.204732 .466252-6.204732C.681445-6.204732 1.255293-6.503611 1.350934-6.766625C1.494396-7.220922 1.530262-7.328518 2.331258-7.436115C2.737733-7.483935 3.132254-7.507846 3.53873-7.507846H4.62665C3.873474-6.77858 3.526775-5.499377 3.096389-3.777833C2.749689-2.367123 2.47472-1.43462 1.984558-.800996C1.865006-.669489 1.853051-.657534 1.530262-.657534H.765131C.537983-.657534 .406476-.657534 .107597-.478207C-.02391-.406476-.286924-.203238-.286924-.083686C-.286924-.011955-.274969 0-.011955 0H4.076712C5.475467 0 6.515567-1.0401 6.515567-1.470486C6.515567-1.554172 6.419925-1.554172 6.38406-1.554172C6.180822-1.554172 5.618929-1.279203 5.499377-.980324C5.415691-.729265 5.379826-.657534 4.782067-.657534H2.49863C3.347447-1.3868 3.706102-2.570361 4.112578-4.196264C4.435367-5.499377 4.722291-6.659029 5.212453-7.388294C5.284184-7.49589 5.296139-7.507846 5.535243-7.507846H6.551432C6.790535-7.507846 6.898132-7.507846 7.208966-7.687173C7.316563-7.746949 7.591532-7.938232 7.591532-8.081694C7.591532-8.153425 7.579577-8.16538 7.316563-8.16538H4.244085Z'/>
</defs>
<g id='eq4-page1'>
<use x='152.974138' y='-4.234107' xlink:href='#eq4-g2-73'/>
<use x='159.483913' y='-2.440844' xlink:href='#eq4-g0-114'/>
<use x='162.137962' y='-2.440844' xlink:href='#eq4-g0-101'/>
<use x='165.676694' y='-2.440844' xlink:href='#eq4-g0-108'/>
<use x='171.711345' y='-4.234107' xlink:href='#eq4-g3-61'/>
<use x='184.136826' y='-13.91787' xlink:href='#eq4-g1-8'/>
<use x='191.110705' y='-4.333785' xlink:href='#eq4-g3-49'/>
<use x='206.926335' y='-4.333785' xlink:href='#eq4-g3-51'/>
<use x='222.741965' y='-4.333785' xlink:href='#eq4-g3-53'/>
<use x='228.594956' y='-13.91787' xlink:href='#eq4-g1-9'/>
</g>
</svg></div><p>Why do we need this information? In Pressio, when we perform hyperreduction, we need to load in the basis on the <em>stencil mesh</em> so that we can reconstruct the state at these points, and eventually evaluate the velocity/residual. However, we only then evaluate the residual at the <em>sample mesh</em>, and thus we need to know what indices in the <em>stencil mesh</em> correspond to those that are on the <em>sample mesh</em>. Makes sense? Great!</p><p>Next, we construct the application/FOM problem object.</p><pre class="m-code"><span class="c1">// Construct the app</span>
<span class="k">using</span> <span class="n">fom_t</span> <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">apps</span><span class="o">::</span><span class="n">swe2d_hyper</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="n">scalar_t</span> <span class="n">params</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">gravity</span><span class="p">,</span> <span class="n">pulse</span><span class="p">,</span> <span class="n">forcing</span><span class="p">};</span>
<span class="n">fom_t</span> <span class="nf">appObj</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">sampleMesh_gids</span><span class="p">,</span> <span class="n">sampleMeshPlusStencil_gids</span><span class="p">);</span></pre><p>Note that here we use the <a href=".">swe2d_<wbr />hyper</a> class, opposed to the <a href=".">swe2d</a> application. These two applications are the same, with the exception that the <em>swe2d_hyper</em> application loads in indices for the sample and stencil mesh, and only computes the velocity/Jacobians at these points. We note that, in the last line where we construct the application, the constructor additionally requires the sample mesh information.</p><p>Next, we read in the basis: for hyper-reduction, we only read in the basis on the <em>stencil mesh</em>. The basis on the full mesh is not required to solve the problem.</p><pre class="m-code"><span class="c1">// -------------------------------------------------------</span>
<span class="c1">// read basis on the sample+stencil mesh</span>
<span class="c1">// -------------------------------------------------------</span>
<span class="k">using</span> <span class="n">decoder_jac_t</span>   <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">containers</span><span class="o">::</span><span class="n">MultiVector</span><span class="o">&lt;</span><span class="n">Eigen</span><span class="o">::</span><span class="n">MatrixXd</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">romSizeTotal</span> <span class="o">=</span> <span class="n">romSizePerDof</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span>
<span class="n">decoder_jac_t</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">readBasis</span><span class="p">(</span><span class="s">&quot;PhiSamplePlusStencil.txt&quot;</span><span class="p">,</span>
              <span class="n">romSizeTotal</span><span class="p">,</span>
              <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">sampleMeshPlusStencilSize</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">numBasis</span> <span class="o">=</span> <span class="n">phi</span><span class="p">.</span><span class="n">numVectors</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span> <span class="n">numBasis</span> <span class="o">!=</span> <span class="n">romSizeTotal</span> <span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span></pre><p>We then use the basis information to construct the decoder. For hyper-reduced LSPG the decoder, in essence, is used to compute the product <svg class="m-math" style="width: 4.040em; height: 1.076em; vertical-align: -0.194em;" viewBox="0 -8.468225 38.780887 10.325252">
<title>
$\boldsymbol \Phi_{\text{stencil}} \hat{\boldsymbol x} $
</title>
<defs>
<path id='eq5-g1-120' d='M6.40797-4.794022C5.977584-4.674471 5.762391-4.267995 5.762391-3.969116C5.762391-3.706102 5.965629-3.419178 6.360149-3.419178C6.77858-3.419178 7.220922-3.765878 7.220922-4.351681C7.220922-4.985305 6.587298-5.403736 5.858032-5.403736C5.176588-5.403736 4.734247-4.889664 4.578829-4.674471C4.27995-5.176588 3.610461-5.403736 2.929016-5.403736C1.422665-5.403736 .609714-3.93325 .609714-3.53873C.609714-3.371357 .789041-3.371357 .896638-3.371357C1.0401-3.371357 1.123786-3.371357 1.171606-3.526775C1.518306-4.614695 2.379078-4.97335 2.86924-4.97335C3.323537-4.97335 3.53873-4.758157 3.53873-4.375592C3.53873-4.148443 3.371357-3.490909 3.263761-3.060523L2.857285-1.422665C2.677958-.6934 2.247572-.334745 1.841096-.334745C1.78132-.334745 1.506351-.334745 1.267248-.514072C1.697634-.633624 1.912827-1.0401 1.912827-1.338979C1.912827-1.601993 1.709589-1.888917 1.315068-1.888917C.896638-1.888917 .454296-1.542217 .454296-.956413C.454296-.32279 1.08792 .095641 1.817186 .095641C2.49863 .095641 2.940971-.418431 3.096389-.633624C3.395268-.131507 4.064757 .095641 4.746202 .095641C6.252553 .095641 7.065504-1.374844 7.065504-1.769365C7.065504-1.936737 6.886177-1.936737 6.77858-1.936737C6.635118-1.936737 6.551432-1.936737 6.503611-1.78132C6.156912-.6934 5.296139-.334745 4.805978-.334745C4.351681-.334745 4.136488-.549938 4.136488-.932503C4.136488-1.183562 4.291905-1.817186 4.399502-2.259527C4.483188-2.570361 4.758157-3.694147 4.817933-3.88543C4.99726-4.60274 5.415691-4.97335 5.834122-4.97335C5.893898-4.97335 6.168867-4.97335 6.40797-4.794022Z'/>
<path id='eq5-g3-94' d='M2.929016-8.296887L1.362889-6.670984L1.554172-6.491656L2.917061-7.723039L4.291905-6.491656L4.483188-6.670984L2.929016-8.296887Z'/>
<path id='eq5-g0-99' d='M3.283686-1.171606L3.172105-1.243337C2.789539-.68543 2.502615-.494147 2.048319-.494147C1.315068-.494147 .812951-1.131756 .812951-2.048319C.812951-2.87721 1.251308-3.435118 1.896887-3.435118C2.183811-3.435118 2.287422-3.347447 2.367123-3.052553L2.414944-2.87721C2.478705-2.646077 2.622167-2.510585 2.797509-2.510585C3.004732-2.510585 3.172105-2.662017 3.172105-2.84533C3.172105-3.291656 2.614197-3.666252 1.944707-3.666252C1.570112-3.666252 1.187547-3.52279 .868742-3.259776C.438356-2.901121 .199253-2.351183 .199253-1.689664C.199253-.661519 .828892 .079701 1.713574 .079701C2.056289 .079701 2.359153-.03188 2.630137-.255044C2.86924-.446326 3.028643-.67746 3.283686-1.171606Z'/>
<path id='eq5-g0-101' d='M3.379328-1.251308L3.251806-1.307098C2.86924-.70137 2.526526-.470237 2.016438-.470237C1.578082-.470237 1.243337-.67746 1.012204-1.107846C.852802-1.41868 .789041-1.697634 .773101-2.207721H3.227895C3.164134-2.725778 3.084433-2.956912 2.885181-3.211955C2.646077-3.498879 2.279452-3.666252 1.865006-3.666252C.876712-3.666252 .199253-2.86924 .199253-1.705604C.199253-.605729 .773101 .079701 1.689664 .079701C2.454795 .079701 3.044583-.390535 3.379328-1.251308ZM2.414944-2.462765H.789041C.876712-3.092403 1.147696-3.379328 1.633873-3.379328S2.311333-3.156164 2.414944-2.462765Z'/>
<path id='eq5-g0-105' d='M2.016438 0V-.119552C1.490411-.159402 1.42665-.239103 1.42665-.812951V-3.642341L1.39477-3.666252L.159402-3.227895V-3.108344L.223163-3.116314C.318804-3.132254 .422416-3.140224 .494147-3.140224C.68543-3.140224 .757161-3.012702 .757161-2.662017V-.812951C.757161-.239103 .67746-.151432 .127522-.119552V0H2.016438ZM1.498381-5.037111C1.498381-5.260274 1.323039-5.443587 1.091905-5.443587C.868742-5.443587 .68543-5.260274 .68543-5.037111C.68543-4.805978 .868742-4.630635 1.091905-4.630635C1.323039-4.630635 1.498381-4.805978 1.498381-5.037111Z'/>
<path id='eq5-g0-108' d='M2.048319 0V-.119552C1.538232-.151432 1.45056-.231133 1.45056-.669489V-5.427646L1.41868-5.443587C1.004234-5.308095 .70137-5.228394 .151432-5.092902V-4.96538H.199253C.286924-4.97335 .382565-4.98132 .446326-4.98132C.70137-4.98132 .781071-4.869738 .781071-4.495143V-.6934C.781071-.263014 .669489-.159402 .167372-.119552V0H2.048319Z'/>
<path id='eq5-g0-110' d='M3.865504 0V-.119552C3.474969-.159402 3.379328-.255044 3.379328-.645579V-2.470735C3.379328-3.219925 3.028643-3.666252 2.438854-3.666252C2.072229-3.666252 1.825156-3.53076 1.283188-3.020672V-3.650311L1.227397-3.666252C.836862-3.52279 .565878-3.435118 .127522-3.307597V-3.172105C.175342-3.196015 .255044-3.203985 .342715-3.203985C.565878-3.203985 .637609-3.084433 .637609-2.693898V-.71731C.637609-.263014 .549938-.151432 .143462-.119552V0H1.833126V-.119552C1.42665-.151432 1.307098-.247073 1.307098-.533998V-2.773599C1.689664-3.132254 1.865006-3.227895 2.12802-3.227895C2.518555-3.227895 2.709838-2.980822 2.709838-2.454795V-.789041C2.709838-.286924 2.606227-.151432 2.207721-.119552V0H3.865504Z'/>
<path id='eq5-g0-115' d='M2.773599-.940473C2.773599-1.338979 2.590286-1.601993 2.10411-1.888917L1.243337-2.399004C1.020174-2.526526 .900623-2.725778 .900623-2.940971C.900623-3.267746 1.147696-3.482939 1.514321-3.482939C1.968618-3.482939 2.207721-3.219925 2.391034-2.502615H2.510585L2.478705-3.58655H2.391034L2.375093-3.57061C2.303362-3.514819 2.295392-3.506849 2.263512-3.506849C2.215691-3.506849 2.13599-3.52279 2.048319-3.56264C1.880946-3.626401 1.697634-3.658281 1.506351-3.658281C.852802-3.658281 .406476-3.259776 .406476-2.677958C.406476-2.231631 .661519-1.920797 1.338979-1.530262L1.801245-1.267248C2.080199-1.107846 2.215691-.916563 2.215691-.669489C2.215691-.318804 1.960648-.095641 1.554172-.095641C1.004234-.095641 .72528-.398506 .541968-1.211457H.414446V.03188H.518057C.573848-.047821 .605729-.063761 .70137-.063761C.789041-.063761 .876712-.047821 1.067995 0C1.291158 .047821 1.490411 .079701 1.657783 .079701C2.263512 .079701 2.773599-.382565 2.773599-.940473Z'/>
<path id='eq5-g0-116' d='M2.223661-.526027L2.12005-.613699C1.944707-.406476 1.817186-.334745 1.641843-.334745C1.346949-.334745 1.227397-.541968 1.227397-1.052055V-3.331507H2.032379V-3.58655H1.227397V-4.511083C1.227397-4.590785 1.211457-4.614695 1.171606-4.614695C1.123786-4.534994 1.067995-4.463263 1.012204-4.391532C.71731-3.953176 .446326-3.658281 .239103-3.53873C.151432-3.482939 .103611-3.435118 .103611-3.387298C.103611-3.363387 .111582-3.347447 .135492-3.331507H.557908V-.932503C.557908-.263014 .797011 .079701 1.259278 .079701C1.657783 .079701 1.960648-.111582 2.223661-.526027Z'/>
<path id='eq5-g2-8' d='M7.12528-7.687173V-8.201245C6.623163-8.177335 5.36787-8.177335 4.805978-8.177335S2.976837-8.177335 2.47472-8.201245V-7.687173H4.064757V-6.43188C1.673724-6.228643 .74122-5.116812 .74122-4.100623C.74122-3.072478 1.685679-1.972603 4.064757-1.769365V-.514072H2.47472V0C2.976837-.02391 4.23213-.02391 4.794022-.02391S6.623163-.02391 7.12528 0V-.514072H5.535243V-1.769365C8.320797-1.972603 8.954421-3.311582 8.954421-4.100623S8.320797-6.228643 5.535243-6.43188V-7.687173H7.12528ZM4.064757-2.187796C2.570361-2.391034 2.367123-3.263761 2.367123-4.100623S2.558406-5.810212 4.064757-6.01345V-2.187796ZM5.535243-6.025405C7.065504-5.846077 7.328518-5.033126 7.328518-4.100623S7.065504-2.355168 5.535243-2.175841V-6.025405Z'/>
</defs>
<g id='eq5-page1'>
<use x='0' y='0' xlink:href='#eq5-g2-8'/>
<use x='9.713574' y='1.793263' xlink:href='#eq5-g0-115'/>
<use x='12.694385' y='1.793263' xlink:href='#eq5-g0-116'/>
<use x='14.910075' y='1.793263' xlink:href='#eq5-g0-101'/>
<use x='18.448807' y='1.793263' xlink:href='#eq5-g0-110'/>
<use x='22.433863' y='1.793263' xlink:href='#eq5-g0-99'/>
<use x='25.972595' y='1.793263' xlink:href='#eq5-g0-105'/>
<use x='28.188285' y='1.793263' xlink:href='#eq5-g0-108'/>
<use x='31.915002' y='-.166034' xlink:href='#eq5-g3-94'/>
<use x='30.902107' y='0' xlink:href='#eq5-g1-120'/>
</g>
</svg>, where <svg class="m-math" style="width: 3.167em; height: 1.048em; vertical-align: -0.194em;" viewBox="0 -8.202578 30.403975 10.059605">
<title>
$\boldsymbol \Phi_{\text{stencil}}$
</title>
<defs>
<path id='eq6-g0-99' d='M3.283686-1.171606L3.172105-1.243337C2.789539-.68543 2.502615-.494147 2.048319-.494147C1.315068-.494147 .812951-1.131756 .812951-2.048319C.812951-2.87721 1.251308-3.435118 1.896887-3.435118C2.183811-3.435118 2.287422-3.347447 2.367123-3.052553L2.414944-2.87721C2.478705-2.646077 2.622167-2.510585 2.797509-2.510585C3.004732-2.510585 3.172105-2.662017 3.172105-2.84533C3.172105-3.291656 2.614197-3.666252 1.944707-3.666252C1.570112-3.666252 1.187547-3.52279 .868742-3.259776C.438356-2.901121 .199253-2.351183 .199253-1.689664C.199253-.661519 .828892 .079701 1.713574 .079701C2.056289 .079701 2.359153-.03188 2.630137-.255044C2.86924-.446326 3.028643-.67746 3.283686-1.171606Z'/>
<path id='eq6-g0-101' d='M3.379328-1.251308L3.251806-1.307098C2.86924-.70137 2.526526-.470237 2.016438-.470237C1.578082-.470237 1.243337-.67746 1.012204-1.107846C.852802-1.41868 .789041-1.697634 .773101-2.207721H3.227895C3.164134-2.725778 3.084433-2.956912 2.885181-3.211955C2.646077-3.498879 2.279452-3.666252 1.865006-3.666252C.876712-3.666252 .199253-2.86924 .199253-1.705604C.199253-.605729 .773101 .079701 1.689664 .079701C2.454795 .079701 3.044583-.390535 3.379328-1.251308ZM2.414944-2.462765H.789041C.876712-3.092403 1.147696-3.379328 1.633873-3.379328S2.311333-3.156164 2.414944-2.462765Z'/>
<path id='eq6-g0-105' d='M2.016438 0V-.119552C1.490411-.159402 1.42665-.239103 1.42665-.812951V-3.642341L1.39477-3.666252L.159402-3.227895V-3.108344L.223163-3.116314C.318804-3.132254 .422416-3.140224 .494147-3.140224C.68543-3.140224 .757161-3.012702 .757161-2.662017V-.812951C.757161-.239103 .67746-.151432 .127522-.119552V0H2.016438ZM1.498381-5.037111C1.498381-5.260274 1.323039-5.443587 1.091905-5.443587C.868742-5.443587 .68543-5.260274 .68543-5.037111C.68543-4.805978 .868742-4.630635 1.091905-4.630635C1.323039-4.630635 1.498381-4.805978 1.498381-5.037111Z'/>
<path id='eq6-g0-108' d='M2.048319 0V-.119552C1.538232-.151432 1.45056-.231133 1.45056-.669489V-5.427646L1.41868-5.443587C1.004234-5.308095 .70137-5.228394 .151432-5.092902V-4.96538H.199253C.286924-4.97335 .382565-4.98132 .446326-4.98132C.70137-4.98132 .781071-4.869738 .781071-4.495143V-.6934C.781071-.263014 .669489-.159402 .167372-.119552V0H2.048319Z'/>
<path id='eq6-g0-110' d='M3.865504 0V-.119552C3.474969-.159402 3.379328-.255044 3.379328-.645579V-2.470735C3.379328-3.219925 3.028643-3.666252 2.438854-3.666252C2.072229-3.666252 1.825156-3.53076 1.283188-3.020672V-3.650311L1.227397-3.666252C.836862-3.52279 .565878-3.435118 .127522-3.307597V-3.172105C.175342-3.196015 .255044-3.203985 .342715-3.203985C.565878-3.203985 .637609-3.084433 .637609-2.693898V-.71731C.637609-.263014 .549938-.151432 .143462-.119552V0H1.833126V-.119552C1.42665-.151432 1.307098-.247073 1.307098-.533998V-2.773599C1.689664-3.132254 1.865006-3.227895 2.12802-3.227895C2.518555-3.227895 2.709838-2.980822 2.709838-2.454795V-.789041C2.709838-.286924 2.606227-.151432 2.207721-.119552V0H3.865504Z'/>
<path id='eq6-g0-115' d='M2.773599-.940473C2.773599-1.338979 2.590286-1.601993 2.10411-1.888917L1.243337-2.399004C1.020174-2.526526 .900623-2.725778 .900623-2.940971C.900623-3.267746 1.147696-3.482939 1.514321-3.482939C1.968618-3.482939 2.207721-3.219925 2.391034-2.502615H2.510585L2.478705-3.58655H2.391034L2.375093-3.57061C2.303362-3.514819 2.295392-3.506849 2.263512-3.506849C2.215691-3.506849 2.13599-3.52279 2.048319-3.56264C1.880946-3.626401 1.697634-3.658281 1.506351-3.658281C.852802-3.658281 .406476-3.259776 .406476-2.677958C.406476-2.231631 .661519-1.920797 1.338979-1.530262L1.801245-1.267248C2.080199-1.107846 2.215691-.916563 2.215691-.669489C2.215691-.318804 1.960648-.095641 1.554172-.095641C1.004234-.095641 .72528-.398506 .541968-1.211457H.414446V.03188H.518057C.573848-.047821 .605729-.063761 .70137-.063761C.789041-.063761 .876712-.047821 1.067995 0C1.291158 .047821 1.490411 .079701 1.657783 .079701C2.263512 .079701 2.773599-.382565 2.773599-.940473Z'/>
<path id='eq6-g0-116' d='M2.223661-.526027L2.12005-.613699C1.944707-.406476 1.817186-.334745 1.641843-.334745C1.346949-.334745 1.227397-.541968 1.227397-1.052055V-3.331507H2.032379V-3.58655H1.227397V-4.511083C1.227397-4.590785 1.211457-4.614695 1.171606-4.614695C1.123786-4.534994 1.067995-4.463263 1.012204-4.391532C.71731-3.953176 .446326-3.658281 .239103-3.53873C.151432-3.482939 .103611-3.435118 .103611-3.387298C.103611-3.363387 .111582-3.347447 .135492-3.331507H.557908V-.932503C.557908-.263014 .797011 .079701 1.259278 .079701C1.657783 .079701 1.960648-.111582 2.223661-.526027Z'/>
<path id='eq6-g1-8' d='M7.12528-7.687173V-8.201245C6.623163-8.177335 5.36787-8.177335 4.805978-8.177335S2.976837-8.177335 2.47472-8.201245V-7.687173H4.064757V-6.43188C1.673724-6.228643 .74122-5.116812 .74122-4.100623C.74122-3.072478 1.685679-1.972603 4.064757-1.769365V-.514072H2.47472V0C2.976837-.02391 4.23213-.02391 4.794022-.02391S6.623163-.02391 7.12528 0V-.514072H5.535243V-1.769365C8.320797-1.972603 8.954421-3.311582 8.954421-4.100623S8.320797-6.228643 5.535243-6.43188V-7.687173H7.12528ZM4.064757-2.187796C2.570361-2.391034 2.367123-3.263761 2.367123-4.100623S2.558406-5.810212 4.064757-6.01345V-2.187796ZM5.535243-6.025405C7.065504-5.846077 7.328518-5.033126 7.328518-4.100623S7.065504-2.355168 5.535243-2.175841V-6.025405Z'/>
</defs>
<g id='eq6-page1'>
<use x='0' y='0' xlink:href='#eq6-g1-8'/>
<use x='9.713574' y='1.793263' xlink:href='#eq6-g0-115'/>
<use x='12.694385' y='1.793263' xlink:href='#eq6-g0-116'/>
<use x='14.910075' y='1.793263' xlink:href='#eq6-g0-101'/>
<use x='18.448807' y='1.793263' xlink:href='#eq6-g0-110'/>
<use x='22.433863' y='1.793263' xlink:href='#eq6-g0-99'/>
<use x='25.972595' y='1.793263' xlink:href='#eq6-g0-105'/>
<use x='28.188285' y='1.793263' xlink:href='#eq6-g0-108'/>
</g>
</svg> is the basis on the <em>stencil mesh</em>.</p><pre class="m-code"><span class="c1">// ------------------------------------------------------</span>
<span class="c1">// construct decoder</span>
<span class="c1">// ------------------------------------------------------</span>
<span class="k">using</span> <span class="n">native_state_t</span>  <span class="o">=</span> <span class="k">typename</span> <span class="nc">fom_t</span><span class="o">::</span><span class="n">state_type</span><span class="p">;</span>
<span class="k">using</span> <span class="n">fom_state_t</span>  <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">containers</span><span class="o">::</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">native_state_t</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">decoder_t</span> <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">rom</span><span class="o">::</span><span class="n">LinearDecoder</span><span class="o">&lt;</span><span class="n">decoder_jac_t</span><span class="p">,</span> <span class="n">fom_state_t</span><span class="o">&gt;</span><span class="p">;</span>
<span class="n">decoder_t</span> <span class="nf">decoderObj</span><span class="p">(</span><span class="n">phi</span><span class="p">);</span></pre><p>Next we create our reference state. For hyper-reduction, Pressio requires the reference state on the <em>stencil_mesh</em>. If we want to view the entire solution field, however, we will also need the reference state on the full mesh. Here, we create both entities:</p><pre class="m-code"><span class="c1">// create the reference vector (on the stencil mesh).</span>
<span class="n">native_state_t</span> <span class="nf">yRef</span><span class="p">(</span><span class="n">appObj</span><span class="p">.</span><span class="n">getGaussianIC</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<span class="c1">// For post processing, we also make a vector on the full mesh</span>
<span class="n">native_state_t</span> <span class="nf">yRefFull</span><span class="p">(</span><span class="n">appObj</span><span class="p">.</span><span class="n">getGaussianICFull</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span></pre><p>We now create the ROM state and initialize it to zero (again, the initial conditions are the reference state), and create the LSPG problem object. We again use the Crank Nicolson time marching scheme. Note that to construct the LSPG ROM proble, the constructor needs the relative sample mesh indices.</p><pre class="m-code"><span class="c1">// -------------------------------------------------------</span>
<span class="c1">// create ROM problem</span>
<span class="c1">// -------------------------------------------------------</span>
<span class="k">using</span> <span class="n">lspg_state_t</span> <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">containers</span><span class="o">::</span><span class="n">Vector</span><span class="o">&lt;</span><span class="n">Eigen</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_t</span><span class="p">,</span><span class="mi">-1</span><span class="p">,</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="p">;</span>
<span class="c1">// define ROM state</span>
<span class="n">lspg_state_t</span> <span class="nf">yROM</span><span class="p">(</span><span class="n">romSizeTotal</span><span class="p">);</span>
<span class="c1">// initialize to zero (reference state is the initial condition)</span>
<span class="n">pressio</span><span class="o">::</span><span class="n">ops</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">yROM</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">);</span>

<span class="c1">// define LSPG type</span>
<span class="k">using</span> <span class="n">ode_tag</span>  <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">ode</span><span class="o">::</span><span class="n">implicitmethods</span><span class="o">::</span><span class="n">CrankNicolson</span><span class="p">;</span>
<span class="k">auto</span> <span class="n">lspgProblem</span> <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">rom</span><span class="o">::</span><span class="n">lspg</span><span class="o">::</span><span class="n">createHyperReducedProblemUnsteady</span>
  <span class="o">&lt;</span><span class="n">ode_tag</span><span class="o">&gt;</span><span class="p">(</span><span class="n">appObj</span><span class="p">,</span> <span class="n">decoderObj</span><span class="p">,</span> <span class="n">yROM</span><span class="p">,</span> <span class="n">yRef</span><span class="p">,</span> <span class="n">sampleMeshRelIds</span><span class="p">);</span></pre><p>The remainder of our driver follows closely that which was written for LSPG. We define our linear and nonlinear solvers:</p><pre class="m-code">  <span class="c1">// linear solver</span>
  <span class="k">using</span> <span class="n">eig_dyn_mat</span>     <span class="o">=</span> <span class="n">Eigen</span><span class="o">::</span><span class="n">Matrix</span><span class="o">&lt;</span><span class="n">scalar_t</span><span class="p">,</span> <span class="mi">-1</span><span class="p">,</span> <span class="mi">-1</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">hessian_t</span>       <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">containers</span><span class="o">::</span><span class="n">DenseMatrix</span><span class="o">&lt;</span><span class="n">eig_dyn_mat</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">solver_tag</span>      <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">linear</span><span class="o">::</span><span class="n">iterative</span><span class="o">::</span><span class="n">LSCG</span><span class="p">;</span>
  <span class="k">using</span> <span class="n">linear_solver_t</span> <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">solvers</span><span class="o">::</span><span class="n">linear</span><span class="o">::</span><span class="n">Solver</span><span class="o">&lt;</span><span class="n">solver_tag</span><span class="p">,</span> <span class="n">hessian_t</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="n">linear_solver_t</span> <span class="n">linSolverObj</span><span class="p">;</span>

  <span class="c1">// GaussNewton solver with normal equations</span>
  <span class="k">auto</span> <span class="n">solver</span> <span class="o">=</span> <span class="n">pressio</span><span class="o">::</span><span class="n">rom</span><span class="o">::</span><span class="n">lspg</span><span class="o">::</span><span class="n">createGaussNewtonSolver</span><span class="p">(</span><span class="n">lspgProblem</span><span class="p">,</span> <span class="n">yROM</span><span class="p">,</span> <span class="n">linSolverObj</span><span class="p">);</span>
  <span class="n">solver</span><span class="p">.</span><span class="n">setTolerance</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">);</span>
  <span class="n">solver</span><span class="p">.</span><span class="n">setMaxIterations</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

  <span class="c1">// define observer to monitor time evolution of generalized coordinates</span>
  <span class="n">observer</span><span class="o">&lt;</span><span class="n">lspg_state_t</span><span class="p">,</span><span class="n">native_state_t</span><span class="o">&gt;</span> <span class="n">Obs</span><span class="p">(</span><span class="n">yRefFull</span><span class="p">);</span>

  <span class="c1">// solve</span>
  <span class="k">const</span> <span class="k">auto</span> <span class="n">Nsteps</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;::</span><span class="n">pressio</span><span class="o">::</span><span class="n">ode</span><span class="o">::</span><span class="n">types</span><span class="o">::</span><span class="n">step_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">finalTime</span><span class="o">/</span><span class="n">dt</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">startTime</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
  <span class="n">pressio</span><span class="o">::</span><span class="n">rom</span><span class="o">::</span><span class="n">lspg</span><span class="o">::</span><span class="n">solveNSequentialMinimizations</span><span class="p">(</span><span class="n">lspgProblem</span><span class="p">,</span> <span class="n">yROM</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">Nsteps</span><span class="p">,</span> <span class="n">Obs</span><span class="p">,</span> <span class="n">solver</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">finishTime</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">elapsed2</span> <span class="o">=</span> <span class="n">finishTime</span> <span class="o">-</span> <span class="n">startTime</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Walltime (single ROM run) = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">elapsed2</span><span class="p">.</span><span class="n">count</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>

  <span class="k">auto</span> <span class="n">yFomFinal</span> <span class="o">=</span> <span class="n">lspgProblem</span><span class="p">.</span><span class="n">fomStateReconstructorCRef</span><span class="p">()(</span><span class="n">yROM</span><span class="p">);</span>
  <span class="k">auto</span> <span class="n">solNorm</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">yFomFinal</span><span class="p">.</span><span class="n">data</span><span class="p">()).</span><span class="n">norm</span><span class="p">();</span>
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">setprecision</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">solNorm</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></pre><p>This completes our description of writing the LSPG hyper-reduction driver. #Click <a href="./md_pages_tutorials_tutorial3.html">here</a> to return to the SWE tutorial.</p>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Pressio|C++ Tutorials. Created with <a href="https://doxygen.org/">Doxygen</a> 1.9.1 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>



\begin{DoxyParagraph}{}
This tutorial demonstrates how to use the pressio/ode component to run explicit time integration for a system of ODEs that uses data types natively supported in pressio. By natively supported, we mean data types that pressio knows how to manipulate and perform computation on, and therefore the user does not need to provide any auxiliary information. Here, we use Eigen data types as an example, but the same code can be used for other natively supported types.
\end{DoxyParagraph}
\hypertarget{md_pages_ode_tutorial1_autotoc_md5}{}\doxysection{Problem}\label{md_pages_ode_tutorial1_autotoc_md5}
We want to integrate in time the following system of ODEs\+: \[ \frac{d \mathbf{y}}{d t} = 10 \mathbf{y} \] where $\mathbf{y} \in R^3$ is the state and $t$ is time.

We first write a class representing our target system of ODEs as follows\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{template}<\textcolor{keyword}{class} scalar\_t>}
\DoxyCodeLine{\textcolor{keyword}{struct }MySystem\{}
\DoxyCodeLine{  \textcolor{keyword}{using} scalar\_type   = scalar\_t;}
\DoxyCodeLine{  \textcolor{keyword}{using} state\_type    = Eigen::Matrix<scalar\_t,-\/1,1>;}
\DoxyCodeLine{  \textcolor{keyword}{using} velocity\_type = state\_type;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  \textcolor{keywordtype}{void} velocity(\textcolor{keyword}{const} state\_type \& y,}
\DoxyCodeLine{                \textcolor{keyword}{const} scalar\_type t,}
\DoxyCodeLine{                velocity\_type \& rhs)\textcolor{keyword}{ const}}
\DoxyCodeLine{\textcolor{keyword}{  }\{}
\DoxyCodeLine{    constexpr scalar\_type ten\{10\};}
\DoxyCodeLine{    rhs(0) = ten * y(0);}
\DoxyCodeLine{    rhs(1) = ten * y(1);}
\DoxyCodeLine{    rhs(2) = ten * y(2);}
\DoxyCodeLine{  \};}
\DoxyCodeLine{}
\DoxyCodeLine{  velocity\_type createVelocity()\textcolor{keyword}{ const}\{}
\DoxyCodeLine{    \textcolor{keywordflow}{return} velocity\_type(3);}
\DoxyCodeLine{  \};}
\DoxyCodeLine{\};}

\end{DoxyCode}
 Note that the data type used for the state is an Eigen vector. The problem class must meet the API needed by pressio to run explicit time integration\+:
\begin{DoxyItemize}
\item it must contain type aliases for scalar, state and velocity (these aliases are detected by pressio)
\item it must contain two overleads of the velocity method (one void and one non-\/void) Note that if you try to use a problem class that does not satisfy the target API, pressio throws a compile-\/time error.
\end{DoxyItemize}\hypertarget{md_pages_ode_tutorial1_autotoc_md6}{}\doxysection{Main function}\label{md_pages_ode_tutorial1_autotoc_md6}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argc, \textcolor{keywordtype}{char} *argv[])}
\DoxyCodeLine{\{}
\DoxyCodeLine{  std::cout << \textcolor{stringliteral}{"{}Running tutorial\(\backslash\)n"{}};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{using} scalar\_type = double;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// create the system/app object}}
\DoxyCodeLine{  \textcolor{keyword}{using} app\_t = MySystem<scalar\_type>;}
\DoxyCodeLine{  app\_t appObj;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// create and initialize the state}}
\DoxyCodeLine{  \textcolor{keyword}{using} native\_state\_t = \textcolor{keyword}{typename} app\_t::state\_type;}
\DoxyCodeLine{  \textcolor{keyword}{using} state\_t        = pressio::containers::Vector<native\_state\_t>;}
\DoxyCodeLine{  state\_t y(3);}
\DoxyCodeLine{  y(0) = 1.; y(1) = 2.; y(2) = 3.;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// instantiate the stepper}}
\DoxyCodeLine{  \textcolor{keyword}{using} ode\_tag   = pressio::ode::explicitmethods::Euler;}
\DoxyCodeLine{  \textcolor{keyword}{using} stepper\_t = pressio::ode::ExplicitStepper<ode\_tag, state\_t, app\_t>;}
\DoxyCodeLine{  stepper\_t stepperObj(y, appObj);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// integrate in time}}
\DoxyCodeLine{  \textcolor{keyword}{const} scalar\_type dt = 0.1;}
\DoxyCodeLine{  \textcolor{keyword}{const} scalar\_type startTime = 0.0;}
\DoxyCodeLine{  \textcolor{keyword}{const} pressio::ode::types::step\_t numSteps = 1;}
\DoxyCodeLine{  pressio::ode::advanceNSteps(stepperObj, y, startTime, dt, numSteps);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// check solution}}
\DoxyCodeLine{  std::cout << \textcolor{stringliteral}{"{}Computed solution: ["{}}}
\DoxyCodeLine{            << y(0) << \textcolor{stringliteral}{"{} "{}} << y(1) << \textcolor{stringliteral}{"{} "{}} << y(2) << \textcolor{stringliteral}{"{}] "{}}}
\DoxyCodeLine{            << \textcolor{stringliteral}{"{}Expected solution: [2,4,6] "{}}}
\DoxyCodeLine{            << std::endl;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\}}

\end{DoxyCode}


We remark the following\+:
\begin{DoxyItemize}
\item The native state is wrapped in a {\ttfamily pressio\+::\+Vector}. Behind the scenes, pressio detects what type you are passing and since Eigen types are supported, pressio knows how to operate on them;
\item For simplicity, we are using forward Euler, but other explicit schemes are supported.
\end{DoxyItemize}\hypertarget{md_pages_ode_tutorial1_autotoc_md7}{}\doxysection{Full Code}\label{md_pages_ode_tutorial1_autotoc_md7}
The full code is available \href{https://github.com/Pressio/pressio-tutorials/blob/main/tutorials/tut_ode_1.cc}{\texttt{ here}}. 